(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     89681,       2064]
NotebookOptionsPosition[     85555,       1986]
NotebookOutlinePosition[     86315,       2009]
CellTagsIndexPosition[     86272,       2006]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Matrix elements  in a Yukawa Model", "Title",
 CellChangeTimes->{{3.845372694159729*^9, 3.845372707741476*^9}, {
  3.845995748126807*^9, 3.845995748301729*^9}, {3.8773539549102507`*^9, 
  3.87735396762534*^9}, {3.929073978083912*^9, 3.92907397972012*^9}, {
  3.933870405451301*^9, 3.9338704081335278`*^9}, {3.934861950081461*^9, 
  3.934861954340464*^9}, {3.935751079272887*^9, 
  3.935751081431068*^9}},ExpressionUUID->"64705e10-4319-45ae-8006-\
0f7fed9a3ce6"],

Cell[CellGroupData[{

Cell["Loading packages", "Chapter",
 CellChangeTimes->{{3.8438364813982077`*^9, 
  3.843836483762822*^9}},ExpressionUUID->"75bede65-65f5-4df8-8be5-\
8763376545fa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$LoadAddOns", "=", 
   RowBox[{"{", "\"\<FeynArts\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<FeynCalc`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FAVerbose", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"FourVector", ",", 
    RowBox[{"FeynCalcInternal", "\[Rule]", "False"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.843795906798201*^9, 3.843795911191774*^9}, {
   3.843795976577758*^9, 3.843795977170793*^9}, {3.843796498335074*^9, 
   3.843796498693701*^9}, {3.843798973992594*^9, 3.843799009718174*^9}, {
   3.84380120162346*^9, 3.843801201967709*^9}, {3.8438024360567923`*^9, 
   3.843802482327758*^9}, {3.845438834150241*^9, 3.8454388505337973`*^9}, {
   3.84543890855401*^9, 3.845438909449184*^9}, 3.845984626474794*^9, 
   3.878104035582633*^9, {3.878104076493684*^9, 3.8781040774004602`*^9}, {
   3.878104364445066*^9, 3.878104364655937*^9}, {3.878104742641322*^9, 
   3.878104742887733*^9}, 3.929073984368247*^9, {3.934346112007848*^9, 
   3.934346121442477*^9}, {3.935645983391458*^9, 3.935645998835178*^9}, {
   3.935646049969775*^9, 3.935646050373325*^9}, {3.935750723745977*^9, 
   3.935750724799377*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5033f070-340c-4a47-af38-98cf26302691"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"FeynCalc \"\>", "Text",
     StripOnInput->False,
     FontWeight->Bold], "\[InvisibleSpace]", 
    StyleBox["\<\"10.0.0 (dev version). For help, use the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{
        RowBox[{"online", " ", "documentation"}], ","}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["https://feyncalc.github.io/referenceDev"], None},
       ButtonNote->"https://feyncalc.github.io/referenceDev"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" visit the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["forum",
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["https://github.com/FeynCalc/feyncalc/discussions"], None},
       ButtonNote->"https://github.com/FeynCalc/feyncalc/discussions/"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" and have a look at the supplied \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"examples", "."}],
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" The PDF-version of the manual can be downloaded \"\>", 
     "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"here", "."}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL[
         "https://github.com/FeynCalc/feyncalc-manual/releases/download/dev-\
manual/FeynCalcManual.pdf"], None},
       ButtonNote->
        "https://github.com/FeynCalc/feyncalc-manual/releases/download/dev-\
manual/FeynCalcManual.pdf"],
      DisplayForm], "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["FeynCalc ", "Text", Bold], 
    Style["10.0.0 (dev version). For help, use the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["online documentation,", ButtonData :> {
         URL["https://feyncalc.github.io/referenceDev"], None}, BaseStyle -> 
       "Hyperlink", ButtonNote -> "https://feyncalc.github.io/referenceDev"]],
      "Text"], 
    Style[" visit the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["forum", ButtonData :> {
         URL["https://github.com/FeynCalc/feyncalc/discussions"], None}, 
       BaseStyle -> "Hyperlink", ButtonNote -> 
       "https://github.com/FeynCalc/feyncalc/discussions/"]], "Text"], 
    Style[" and have a look at the supplied ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "examples.", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]], Evaluator -> 
       Automatic, Method -> "Preemptive"]], "Text"], 
    Style[" The PDF-version of the manual can be downloaded ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["here.", ButtonData :> {
         URL[
         "https://github.com/FeynCalc/feyncalc-manual/releases/download/dev-\
manual/FeynCalcManual.pdf"], None}, BaseStyle -> "Hyperlink", ButtonNote -> 
       "https://github.com/FeynCalc/feyncalc-manual/releases/download/dev-\
manual/FeynCalcManual.pdf"]], "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.9357507088369493`*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614802294*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"1727780b-2ff4-4b53-b6ad-4ee7bc7618c3"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"If you use FeynCalc in your research, please evaluate \
FeynCalcHowToCite[] to learn how to cite this software.\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.9357507088369493`*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.9357516148036833`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"0447ef80-4965-4dbb-873d-162ed5bfd309"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"Please keep in mind that the proper academic attribution of \
our work is crucial to ensure the future development of this package!\"\>", 
   "Text",
   StripOnInput->False,
   FontSlant->Italic], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.9357507088369493`*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614804089*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"fd5978ce-bde4-442d-864c-254e91c84596"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"FeynArts \"\>", "Text",
     StripOnInput->False,
     FontWeight->Bold], "\[InvisibleSpace]", 
    StyleBox["\<\"3.11 (25 Mar 2022) patched for use with FeynCalc, for \
documentation see the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["manual",
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         First[
          FileNames[{"*.pdf", "*.PDF"}, 
           FileNameJoin[{FeynCalc`$FeynArtsDirectory, "manual"}]]]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" or visit \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"www", ".", "feynarts", ".", "de", "."}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["http://www.feynarts.de/"], None},
       ButtonNote->"www.feynarts.de/"],
      DisplayForm], "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["FeynArts ", "Text", Bold], 
    Style[
    "3.11 (25 Mar 2022) patched for use with FeynCalc, for documentation see \
the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "manual", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         First[
          FileNames[{"*.pdf", "*.PDF"}, 
           FileNameJoin[{FeynCalc`$FeynArtsDirectory, "manual"}]]]], 
       Evaluator -> Automatic, Method -> "Preemptive"]], "Text"], 
    Style[" or visit ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["www.feynarts.de.", ButtonData :> {
         URL["http://www.feynarts.de/"], None}, BaseStyle -> "Hyperlink", 
       ButtonNote -> "www.feynarts.de/"]], "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.9357507088369493`*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614843103*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a2c86c7b-bf58-4550-bd66-baffcc103459"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"If you use FeynArts in your research, please cite\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.9357507088369493`*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614843726*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"7f777727-6b04-47a0-b39a-b242a66380c7"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\" \[Bullet] T. Hahn, Comput. Phys. Commun., 140, 418-431, \
2001, arXiv:hep-ph/0012260\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.9357507088369493`*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.93575161484413*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"3a29860f-b4a8-463e-8594-dda929423e62"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"I", " ", 
    RowBox[{"don", "'"}], "t", " ", "like", " ", "traditional", " ", "form"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FCDisableTraditionalFormOutput", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.929076316526704*^9, 3.929076325891109*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"02f92399-fcbe-4bc1-9117-792392e1d5c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Choosing model", "Chapter",
 CellChangeTimes->{{3.846050434940159*^9, 
  3.846050436476512*^9}},ExpressionUUID->"f5b17365-e344-4951-a8bf-\
682379c5dff6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "is", " ", "where", " ", "the", " ", "FeynArts", " ", 
     "files", " ", "made", " ", "by", " ", "FeynRules", " ", "can", " ", "be",
      " ", "found"}], ",", " ", 
    RowBox[{"ending", " ", 
     RowBox[{"in", " ", ".", "gen"}], " ", 
     RowBox[{"and", " ", ".", "mod"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"model", "=", "\"\<yukawa\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modLoc", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "model"}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"genericLoc", "=", "modLoc"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitializeModel", "[", 
     RowBox[{"modLoc", ",", 
      RowBox[{"GenericModel", "->", "modLoc"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.933870596031344*^9, {3.934346514065029*^9, 3.934346515479988*^9}, {
   3.934862066924714*^9, 3.934862095258631*^9}, {3.935637720444118*^9, 
   3.935637745481882*^9}, 3.9356452532929363`*^9, {3.935648756824701*^9, 
   3.935648767149409*^9}, {3.935743484834828*^9, 3.935743491507557*^9}, {
   3.9357504184822683`*^9, 3.935750419124872*^9}, {3.935750452389639*^9, 
   3.93575047458*^9}, {3.935750628286405*^9, 3.935750643961434*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"f40b35fa-4a17-4c6c-b392-b40cd7767db7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "relevant", " ", "processes", " ", "for", " ", "Boltzmann", " ", 
    "collision", " ", "integrals", " ", "with", " ", "given", " ", "particle",
     " ", "in", " ", "position", " ", "p1"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"particleTypes", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"F$Particles", ",", 
       RowBox[{
        RowBox[{"U", "[", "1", "]"}], "|", 
        RowBox[{"-", 
         RowBox[{"U", "[", "1", "]"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"particleNames", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"TheLabel", "[", "#", "]"}], "]"}], "<>", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "Times"}], ",", 
          "\"\<bar\>\"", ",", "\"\<\>\""}], "]"}]}], "&"}], ",", 
      "particleTypes"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeProcesses", "[", "firstParticle_", "]"}], ":=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"firstParticle", ",", "a"}], "}"}], "->", 
           RowBox[{"{", 
            RowBox[{"b", ",", "c"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "particleTypes"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "particleTypes"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "particleTypes"}], "}"}]}], "]"}], ",", "2"}], 
       "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.929163473923676*^9, 3.929163498308498*^9}, {
   3.933870450444408*^9, 3.933870492654088*^9}, {3.933870524985799*^9, 
   3.933870525413417*^9}, {3.934862117286737*^9, 3.934862198838484*^9}, {
   3.934862661988862*^9, 3.934862817762034*^9}, {3.934862853627457*^9, 
   3.934862856412826*^9}, {3.934863230814647*^9, 3.934863262468681*^9}, {
   3.935637237364757*^9, 3.935637240473458*^9}, {3.935728360482558*^9, 
   3.935728364456549*^9}, {3.935728623070777*^9, 3.935728637279348*^9}, {
   3.935728855665764*^9, 3.9357289126182127`*^9}, {3.93572894276196*^9, 
   3.935728959897721*^9}, 3.935750676733197*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"5ebc72a0-de0d-43df-83e8-50a95768348a"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"Phi\"\>", ",", "\<\"Psi\"\>", ",", "\<\"Psibar\"\>"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.935728888385016*^9, 3.935728914446125*^9}, {
   3.935728956700542*^9, 3.935728963379753*^9}, 3.935735973592854*^9, 
   3.935739075459318*^9, 3.935750730580076*^9, 3.935751231979793*^9, 
   3.9357516151289167`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"fa90964d-6141-4975-bd52-98f36035d7e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"getting", " ", "expressions", " ", "for", " ", "parameters"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Get", "[", 
    RowBox[{"modLoc", "<>", "\"\<.pars\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"parameters", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "M$ExtParams"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.935750756150154*^9, 3.935750756266836*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"df2f9d8f-c63f-4724-81dc-18372eea0a54"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"g", ",", "lam", ",", "mPhi", ",", "mPsi", ",", "msq", ",", "y"}], 
   "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.935750742416089*^9, 3.9357507565803556`*^9}, 
   3.935751233690605*^9, 3.935751615133554*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"47224435-695a-43b2-bf36-db5752b24159"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"indices", " ", "for", " ", "particles"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mapParticleToInteger", ":=", 
     RowBox[{"Thread", "[", 
      RowBox[{"particleTypes", "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "particleTypes", "]"}], "]"}], "-", "1"}], 
        ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "mapParticleToInteger", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"makeMName", "[", "process_", "]"}], ":=", 
    RowBox[{
     RowBox[{"M", "[", 
      RowBox[{
       RowBox[{"process", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"process", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"process", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"process", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "/.", 
     "mapParticleToInteger"}]}]}]}]], "Input",
 CellChangeTimes->{{3.935519108771131*^9, 3.935519116409436*^9}, {
  3.935519159054694*^9, 3.935519166683959*^9}, {3.935750797899083*^9, 
  3.935750804846677*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"23039e3d-3c71-4845-88f7-37037ba7ce4d"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "(", "1", ")"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"F", "(", "1", ")"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"F", "(", "1", ")"}]}], "\[Rule]", "2"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9355191187522*^9, 3.935519167011503*^9, 3.935519393176126*^9, 
   3.9355194287264843`*^9, {3.935637215579294*^9, 3.935637244301227*^9}, 
   3.935638798636213*^9, 3.9356455885133677`*^9, 3.9357273919787703`*^9, 
   3.935728967561171*^9, 3.935735973610675*^9, 3.9357390754797983`*^9, 
   3.935750808860111*^9, 3.935751234481867*^9, 3.9357513016668663`*^9, 
   3.935751615143201*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"0d390b9d-6b87-40b8-84c5-93a26d80e869"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing matrix elements", "Chapter",
 CellChangeTimes->{{3.929075763355721*^9, 3.929075766225482*^9}, {
  3.93575162099209*^9, 
  3.935751624182454*^9}},ExpressionUUID->"49004534-9081-4e18-af70-\
0f8568b2a3a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dimension", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tops", "=", 
   RowBox[{"CreateTopologies", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "->", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momenta", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Momentum", "[", 
      RowBox[{"p1", ",", "dimension"}], "]"}], ",", 
     RowBox[{"Momentum", "[", 
      RowBox[{"p2", ",", "dimension"}], "]"}], ",", 
     RowBox[{"Momentum", "[", 
      RowBox[{"p3", ",", "dimension"}], "]"}], ",", 
     RowBox[{"Momentum", "[", 
      RowBox[{"p4", ",", "dimension"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indices", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.933906889130355*^9, {3.933911817358987*^9, 3.93391182182825*^9}, {
   3.933913202394904*^9, 3.9339132318972683`*^9}, {3.9343472014290457`*^9, 
   3.934347204249823*^9}, {3.934347277247624*^9, 3.934347305727003*^9}, {
   3.93434773088161*^9, 3.934347739456812*^9}, {3.934348072313307*^9, 
   3.934348083723092*^9}, {3.9343492360717278`*^9, 3.934349240257479*^9}, {
   3.934349355127749*^9, 3.934349355289405*^9}, 3.9343494753243437`*^9, {
   3.934350122837312*^9, 3.934350143607397*^9}, {3.934862455790564*^9, 
   3.93486245771926*^9}, {3.935646873751331*^9, 3.935646898405034*^9}, {
   3.935727436098512*^9, 3.935727459237951*^9}, {3.9357508274507093`*^9, 
   3.935750842476226*^9}, {3.935751095584155*^9, 3.935751095992384*^9}, 
   3.935751265354184*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"e19637cd-9246-483f-9865-9af615165b4a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "makeAmplitude", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeAmplitude", "[", 
   RowBox[{"process_", ",", 
    RowBox[{"channels_", ":", "All"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "diags", ",", "ampFA", ",", "ampFC", ",", "ampSq", ",", " ", "ampMsq", 
      ",", "ampMsqSummed", ",", "masses", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"assumes", " ", "2"}], "->", 
      RowBox[{"2", " ", "topology"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"create", " ", "diagrams", " ", "for", " ", "process"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"diags", "=", 
      RowBox[{"InsertFields", "[", 
       RowBox[{
        RowBox[{"tops", "[", 
         RowBox[{"[", "channels", "]"}], "]"}], ",", "process", ",", 
        RowBox[{"InsertionLevel", "\[Rule]", 
         RowBox[{"{", "Particles", "}"}]}], ",", 
        RowBox[{"Model", "->", "modLoc"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "create", " ", "FeynArts", " ", "amplitude", " ", "from", " ", 
       "diagrams"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampFA", "[", "1", "]"}], "=", 
      RowBox[{"CreateFeynAmp", "[", 
       RowBox[{"diags", ",", 
        RowBox[{"PreFactor", "\[Rule]", "1"}], ",", 
        RowBox[{"Truncated", "->", "False"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"converting", " ", "to", " ", "FeynCalc", " ", "form"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampFC", "[", "1", "]"}], "=", 
      RowBox[{"FCFAConvert", "[", 
       RowBox[{
        RowBox[{"ampFA", "[", "1", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"IncomingMomenta", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Momentum", "[", 
            RowBox[{"p1", ",", "dimension"}], "]"}], ",", 
           RowBox[{"Momentum", "[", 
            RowBox[{"p2", ",", "dimension"}], "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OutgoingMomenta", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Momentum", "[", 
            RowBox[{"p3", ",", "dimension"}], "]"}], ",", 
           RowBox[{"Momentum", "[", 
            RowBox[{"p4", ",", "dimension"}], "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"LorentzIndexNames", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Rho]", ",", "\[Sigma]"}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ChangeDimension", "\[Rule]", "dimension"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"List", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"SMP", "->", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Contract", "->", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"DropSumOver", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"UndoChiralSplittings", "->", "True"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"ampFC", "[", "1", "]"}], "//", "Contract"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.929075894107052*^9, 3.929076057213236*^9}, {
   3.9290761037433767`*^9, 3.929076166392042*^9}, {3.929092064719689*^9, 
   3.929092093544846*^9}, {3.929092123841778*^9, 3.929092165646528*^9}, {
   3.9290922082292423`*^9, 3.92909225087777*^9}, {3.9290923353190823`*^9, 
   3.929092412608399*^9}, {3.9290924917604847`*^9, 3.929092492385458*^9}, {
   3.929092536115327*^9, 3.9290925608221817`*^9}, {3.929092677450205*^9, 
   3.929092763497978*^9}, {3.929092878724598*^9, 3.929092900788889*^9}, {
   3.929092966958254*^9, 3.929093015909559*^9}, {3.929093105335787*^9, 
   3.929093110372094*^9}, {3.929094887607358*^9, 3.929094891200402*^9}, {
   3.929094933951954*^9, 3.929094938108746*^9}, {3.929163133641143*^9, 
   3.929163152160817*^9}, {3.929163194794945*^9, 3.929163195429078*^9}, {
   3.929163350361196*^9, 3.929163356957172*^9}, {3.929207089205179*^9, 
   3.929207124707587*^9}, {3.92920756189178*^9, 3.929207562137615*^9}, {
   3.929207953021226*^9, 3.929207954224873*^9}, {3.929593994245974*^9, 
   3.929593999837923*^9}, {3.929594287483955*^9, 3.929594295349435*^9}, 
   3.929603534835824*^9, {3.929603570882513*^9, 3.929603575003572*^9}, {
   3.929603722308836*^9, 3.929603724509448*^9}, 3.929604579949868*^9, 
   3.933825157614958*^9, {3.933906901186544*^9, 3.933906907912687*^9}, {
   3.933911698385335*^9, 3.933911722793387*^9}, {3.933911758579893*^9, 
   3.933911793157419*^9}, {3.933913243761017*^9, 3.933913244461969*^9}, {
   3.933913971519474*^9, 3.933913981363091*^9}, {3.934340794293929*^9, 
   3.934340798870564*^9}, {3.934343007587886*^9, 3.93434300799966*^9}, {
   3.934343119738257*^9, 3.934343124875223*^9}, {3.934343169929793*^9, 
   3.934343181521282*^9}, 3.934343220573367*^9, {3.934343283950222*^9, 
   3.9343433167415743`*^9}, {3.934343346932787*^9, 3.93434343306151*^9}, {
   3.934347015073876*^9, 3.9343471102880707`*^9}, {3.934347418288307*^9, 
   3.934347436618711*^9}, {3.9343475953451233`*^9, 3.934347603274523*^9}, {
   3.934348397000737*^9, 3.934348404042808*^9}, {3.934349458757903*^9, 
   3.934349458911173*^9}, 3.935641403517545*^9, 3.935641853911125*^9, {
   3.935646562899584*^9, 3.93564661671967*^9}, {3.935646778734145*^9, 
   3.935646804780753*^9}, {3.93564805226012*^9, 3.935648072231864*^9}, {
   3.93564873787033*^9, 3.935648740503065*^9}, {3.935751037794231*^9, 
   3.935751040221115*^9}, 3.935751104084297*^9, 3.935751242758947*^9, {
   3.935751320403571*^9, 3.935751320515009*^9}, {3.935751741671961*^9, 
   3.935751767719939*^9}},ExpressionUUID->"8680e620-c5fd-4647-b023-\
22fc997a15a9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "makeAmplitudeSquared", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeAmplitudeSquared", "[", 
   RowBox[{"process_", ",", 
    RowBox[{"channels_", ":", "All"}], ",", 
    RowBox[{"simplify_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ampM", ",", "ampSq", ",", " ", "ampMsq", ",", "masses", ",", "stu", ",",
       "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"assumes", " ", "2"}], "->", 
      RowBox[{"2", " ", "topology"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"masses", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"TheMass", ",", 
          RowBox[{"process", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{"TheMass", ",", 
          RowBox[{"process", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stu", "=", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{"masses", "^", "2"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampM", "[", "1", "]"}], "=", 
      RowBox[{"makeAmplitude", "[", 
       RowBox[{"process", ",", "channels"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"making", " ", "amplitude", " ", "squared"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampSq", "[", "1", "]"}], "=", 
      RowBox[{
       RowBox[{"ComplexConjugate", "[", 
        RowBox[{"ampM", "[", "1", "]"}], "]"}], 
       RowBox[{"ampM", "[", "1", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampSq", "[", "2", "]"}], "=", 
      RowBox[{"FeynAmpDenominatorExplicit", "[", 
       RowBox[{"ampSq", "[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"FCClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"insert", " ", "Mandelstam", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"SetMandelstam", "[", 
      RowBox[{"s", ",", "t", ",", "u", ",", "p1", ",", "p2", ",", 
       RowBox[{"-", "p3"}], ",", 
       RowBox[{"-", "p4"}], ",", 
       RowBox[{"(", 
        RowBox[{"masses", "/.", 
         RowBox[{"List", "->", "Sequence"}]}], ")"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampSq", "[", "2", "]"}], "=", 
      RowBox[{
       RowBox[{"FermionSpinSum", "[", 
        RowBox[{"ampSq", "[", "2", "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"DiracTrace", "[", "aaa__", "]"}], "->", 
        RowBox[{"DiracTrace", "[", 
         RowBox[{"aaa", ",", 
          RowBox[{"Mandelstam", "->", 
           RowBox[{"{", 
            RowBox[{"s", ",", "t", ",", "u", ",", "stu"}], "}"}]}]}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampSq", "[", "3", "]"}], "=", 
      RowBox[{"DiracSimplify", "[", 
       RowBox[{"ampSq", "[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", "simplify", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampMsq", "[", "1", "]"}], "=", 
      RowBox[{"Expand", "[", 
       RowBox[{"TrickMandelstam", "[", 
        RowBox[{
         RowBox[{"ampSq", "[", "3", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "t", ",", "u", ",", 
           RowBox[{"Plus", "@@", 
            RowBox[{"(", "masses", ")"}]}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FCClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Return", "[", 
      RowBox[{"ampMsq", "[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.929163292792371*^9, 3.929163358613777*^9}, {
   3.929163391434505*^9, 3.929163397696303*^9}, {3.929207568257083*^9, 
   3.929207600997341*^9}, {3.929207646151352*^9, 3.929207646270399*^9}, {
   3.9292079237436*^9, 3.929207937092461*^9}, {3.92920803270984*^9, 
   3.929208032829627*^9}, {3.929417933803673*^9, 3.929417965977117*^9}, {
   3.929418174849358*^9, 3.929418175258651*^9}, {3.929594393852467*^9, 
   3.929594401188664*^9}, {3.929603578465671*^9, 3.929603580647114*^9}, {
   3.929603657355739*^9, 3.9296036680053453`*^9}, {3.9296037535567293`*^9, 
   3.9296037536002007`*^9}, {3.9296038742334538`*^9, 3.929603951549081*^9}, {
   3.929604014027938*^9, 3.929604033682198*^9}, {3.929604259235312*^9, 
   3.929604268592654*^9}, {3.929604405439997*^9, 3.929604446934186*^9}, {
   3.92960453885318*^9, 3.9296045424743*^9}, 3.929604654550357*^9, {
   3.929604732921293*^9, 3.929604749756429*^9}, {3.929704132124748*^9, 
   3.929704143415285*^9}, {3.933827862166714*^9, 3.933827867647903*^9}, 
   3.933911642926285*^9, {3.933911801336119*^9, 3.933911803535879*^9}, {
   3.933911892837012*^9, 3.933911927143033*^9}, {3.933912143369272*^9, 
   3.933912147439457*^9}, {3.933912487506222*^9, 3.933912491510787*^9}, {
   3.933913186637265*^9, 3.933913186673224*^9}, {3.933913252636944*^9, 
   3.933913252861935*^9}, {3.933913858373026*^9, 3.933913860960552*^9}, {
   3.933913907702012*^9, 3.933913923599736*^9}, {3.933914166161413*^9, 
   3.933914183688211*^9}, {3.93391426941628*^9, 3.93391429624463*^9}, {
   3.933914352556963*^9, 3.933914354893138*^9}, {3.933914457098569*^9, 
   3.933914475505293*^9}, 3.933914545173667*^9, {3.934340552204359*^9, 
   3.93434055912149*^9}, {3.93434081963873*^9, 3.9343408354724407`*^9}, {
   3.934347115803708*^9, 3.934347178475627*^9}, {3.934347330064329*^9, 
   3.934347335516551*^9}, {3.934347403077129*^9, 3.93434740475576*^9}, {
   3.934347610410492*^9, 3.9343476193673*^9}, {3.934347701572644*^9, 
   3.934347709534422*^9}, {3.934348465346504*^9, 3.9343484675978527`*^9}, {
   3.934349002057576*^9, 3.934349075476183*^9}, {3.934349147881852*^9, 
   3.934349223993475*^9}, {3.934349273341917*^9, 3.934349320750496*^9}, {
   3.934349374515761*^9, 3.934349456722463*^9}, {3.934350059922199*^9, 
   3.934350105961728*^9}, {3.934350150505369*^9, 3.934350247075732*^9}, {
   3.9343502932126093`*^9, 3.93435041680386*^9}, {3.934350462385359*^9, 
   3.934350495856331*^9}, {3.9348629433086796`*^9, 3.934862965899262*^9}, {
   3.9348630503643427`*^9, 3.934863153510377*^9}, {3.935490579087469*^9, 
   3.935490580471187*^9}, 3.9356418686453876`*^9, 3.935646731438892*^9, {
   3.935646828492881*^9, 3.9356468288691*^9}, {3.93564688891681*^9, 
   3.935646901214143*^9}, 3.935646945411313*^9, {3.935646977848309*^9, 
   3.935646998151428*^9}, {3.935648154671014*^9, 3.935648213424527*^9}, {
   3.935648264366455*^9, 3.935648295152978*^9}, {3.935648327586478*^9, 
   3.935648411282057*^9}, {3.935648477462486*^9, 3.935648502976279*^9}, {
   3.935648537921468*^9, 3.935648553080236*^9}, {3.935648937980735*^9, 
   3.935648997526138*^9}, {3.935727959103112*^9, 3.935727961414198*^9}, {
   3.93572820087499*^9, 3.935728286233938*^9}, {3.935729275219878*^9, 
   3.935729287165559*^9}, {3.935729335230828*^9, 3.935729336698476*^9}, {
   3.9357293927524242`*^9, 3.935729407949136*^9}, {3.935729734679187*^9, 
   3.935729737225625*^9}, {3.935730011206323*^9, 3.935730012366373*^9}, {
   3.9357510201436977`*^9, 3.9357510244542217`*^9}, {3.935751135499444*^9, 
   3.935751171150434*^9}, 3.9357513366476192`*^9, {3.935751772929392*^9, 
   3.935751775372311*^9}},ExpressionUUID->"c63ce969-75cd-4863-abef-\
d2197a5b96a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "squared", " ", "summed", " ", "matrix", " ", "elements", " ", "with", " ",
     "a", " ", "scalar", " ", "on", " ", "leg", " ", "1"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"scalar", "=", 
     RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"makeMName", "[", "process", "]"}], "->", 
          RowBox[{"makeAmplitudeSquared", "[", 
           RowBox[{"process", ",", "All", ",", "False"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"process", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"makeProcesses", "[", 
             RowBox[{"S", "[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"_", "->", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"setting", " ", "masses", " ", "to", " ", "zero"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"scalar0", "=", 
    RowBox[{"scalar", "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"TheMass", ",", "particleTypes"}], "]"}], "->", "0"}], 
      "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.929091074316017*^9, 3.929091079903058*^9}, {
   3.9290925763592443`*^9, 3.929092583721365*^9}, {3.929092629218905*^9, 
   3.92909265404535*^9}, {3.929092722043857*^9, 3.929092724309412*^9}, {
   3.929092768393488*^9, 3.929092791433598*^9}, {3.92916321996157*^9, 
   3.9291632249565487`*^9}, 3.929163418931231*^9, {3.92920772606059*^9, 
   3.92920774667478*^9}, {3.929208095195298*^9, 3.92920809697257*^9}, {
   3.9292082796499357`*^9, 3.929208282279414*^9}, {3.929416888297733*^9, 
   3.929416893009259*^9}, {3.929417258804387*^9, 3.929417261885689*^9}, {
   3.929417521594604*^9, 3.929417527606262*^9}, 3.929417590939068*^9, {
   3.9294181419219646`*^9, 3.929418171068711*^9}, {3.929594322435501*^9, 
   3.92959442197842*^9}, {3.929594488321137*^9, 3.929594503925781*^9}, {
   3.933911996600327*^9, 3.933911999898604*^9}, {3.933914568486231*^9, 
   3.933914569289371*^9}, {3.934350604049673*^9, 3.9343506590434933`*^9}, {
   3.934350729677734*^9, 3.934350730254113*^9}, {3.935728419530217*^9, 
   3.935728422145665*^9}, {3.9357290003561077`*^9, 3.9357290053984747`*^9}, {
   3.935729868439177*^9, 3.935729871011324*^9}, {3.935730180867995*^9, 
   3.935730181343759*^9}, {3.935751185740436*^9, 3.935751188462908*^9}, {
   3.93575135159918*^9, 3.935751391818954*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"727254a6-a14c-4fb9-a9bd-ca992ffc33ec"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], ")"}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["g", "4"], " ", 
        SuperscriptBox["u", "2"]}], 
       RowBox[{
        SuperscriptBox["s", "2"], " ", 
        SuperscriptBox["t", "2"]}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["g", "4"], " ", 
        SuperscriptBox["t", "2"]}], 
       RowBox[{
        SuperscriptBox["s", "2"], " ", 
        SuperscriptBox["u", "2"]}]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["g", "4"], " ", "u"}], 
       RowBox[{
        SuperscriptBox["s", "2"], " ", "t"}]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["g", "4"], " ", "t"}], 
       RowBox[{
        SuperscriptBox["s", "2"], " ", "u"}]], "+", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["g", "4"]}], 
       SuperscriptBox["s", "2"]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"], " ", "lam", " ", "u"}], 
       RowBox[{"s", " ", "t"}]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"], " ", "lam", " ", "t"}], 
       RowBox[{"s", " ", "u"}]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"], " ", "lam"}], "s"], "+", 
      SuperscriptBox["lam", "2"]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"0", ",", "0", ",", "1", ",", "2"}], ")"}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["y", "2"]}], "s"], "+", 
      FractionBox[
       RowBox[{"2", " ", "u", " ", 
        SuperscriptBox["y", "4"]}], "t"], "+", 
      FractionBox[
       RowBox[{"2", " ", "t", " ", 
        SuperscriptBox["y", "4"]}], "u"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"0", ",", "0", ",", "2", ",", "1"}], ")"}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["y", "2"]}], "s"], "+", 
      FractionBox[
       RowBox[{"2", " ", "u", " ", 
        SuperscriptBox["y", "4"]}], "t"], "+", 
      FractionBox[
       RowBox[{"2", " ", "t", " ", 
        SuperscriptBox["y", "4"]}], "u"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"], " ", 
         SuperscriptBox["y", "2"]}], "t"]}], "-", 
      FractionBox[
       RowBox[{"2", " ", "u", " ", 
        SuperscriptBox["y", "4"]}], "s"], "-", 
      FractionBox[
       RowBox[{"2", " ", "s", " ", 
        SuperscriptBox["y", "4"]}], "u"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"0", ",", "1", ",", "1", ",", "0"}], ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"], " ", 
         SuperscriptBox["y", "2"]}], "u"]}], "-", 
      FractionBox[
       RowBox[{"2", " ", "t", " ", 
        SuperscriptBox["y", "4"]}], "s"], "-", 
      FractionBox[
       RowBox[{"2", " ", "s", " ", 
        SuperscriptBox["y", "4"]}], "t"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"0", ",", "2", ",", "0", ",", "2"}], ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"], " ", 
         SuperscriptBox["y", "2"]}], "t"]}], "-", 
      FractionBox[
       RowBox[{"2", " ", "u", " ", 
        SuperscriptBox["y", "4"]}], "s"], "-", 
      FractionBox[
       RowBox[{"2", " ", "s", " ", 
        SuperscriptBox["y", "4"]}], "u"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"0", ",", "2", ",", "2", ",", "0"}], ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"], " ", 
         SuperscriptBox["y", "2"]}], "u"]}], "-", 
      FractionBox[
       RowBox[{"2", " ", "t", " ", 
        SuperscriptBox["y", "4"]}], "s"], "-", 
      FractionBox[
       RowBox[{"2", " ", "s", " ", 
        SuperscriptBox["y", "4"]}], "t"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.929092787505382*^9, 3.929092791847307*^9}, 
   3.9290929117995033`*^9, 3.929163164213238*^9, {3.929163204991143*^9, 
   3.929163225241644*^9}, 3.929163419336918*^9, 3.929207152449558*^9, {
   3.929207659245302*^9, 3.929207688579218*^9}, {3.929207729965206*^9, 
   3.929207748216619*^9}, 3.929208056182027*^9, {3.929208097566613*^9, 
   3.929208105859912*^9}, 3.929208282722217*^9, 3.929416601408811*^9, 
   3.92941676294796*^9, 3.929416893896282*^9, 3.929417263181375*^9, 
   3.929417528614611*^9, 3.929417596915107*^9, 3.929418017334605*^9, {
   3.929418137067355*^9, 3.929418182368412*^9}, 3.929418352429031*^9, 
   3.9294185377206373`*^9, 3.9294185789203453`*^9, 3.929418688279768*^9, 
   3.929419696567276*^9, 3.929419744512654*^9, {3.929420075264696*^9, 
   3.92942010345995*^9}, 3.9294362812534847`*^9, 3.929532797056683*^9, 
   3.9295935245622883`*^9, 3.929594027468538*^9, {3.929594317488683*^9, 
   3.929594376577021*^9}, {3.929594410907151*^9, 3.929594422965923*^9}, 
   3.929594505685652*^9, 3.929604765391562*^9, 3.929604853580666*^9, 
   3.929605194421558*^9, 3.929606941985746*^9, 3.929701898651478*^9, 
   3.929704149727519*^9, 3.929704599335544*^9, 3.9297925922645693`*^9, 
   3.930123084268579*^9, 3.930281986392529*^9, 3.933132011926148*^9, 
   3.933825192475563*^9, 3.933912000757508*^9, {3.933914561213335*^9, 
   3.933914570968072*^9}, 3.934340581228056*^9, 3.934350038201454*^9, 
   3.934350549812847*^9, {3.9343506071960793`*^9, 3.934350629209667*^9}, 
   3.93435066398417*^9, 3.934350732684205*^9, 3.9357290207061977`*^9, 
   3.935729903384771*^9, 3.935730090878389*^9, 3.935739070782056*^9, 
   3.935739150589118*^9, {3.935751190883871*^9, 3.935751212465646*^9}, 
   3.935751278937862*^9, {3.935751310396468*^9, 3.93575134130859*^9}, {
   3.935751381395361*^9, 3.935751394928157*^9}, 3.9357517009164333`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"6dd3c206-3f36-48d0-b588-9a0767f05e73"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "squared", " ", "summed", " ", "matrix", " ", "elements", " ", "with", 
     " ", "a", " ", "top", " ", "or", " ", "anti"}], "-", 
    RowBox[{"top", " ", "on", " ", "leg", " ", "1"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fermion", "=", 
     RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"makeMName", "[", "process", "]"}], "->", 
            RowBox[{"makeAmplitudeSquared", "[", 
             RowBox[{"process", ",", "All", ",", "False"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"process", ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"makeProcesses", "[", 
               RowBox[{"F", "[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"makeMName", "[", "process", "]"}], "->", 
            RowBox[{"makeAmplitudeSquared", "[", 
             RowBox[{"process", ",", "All", ",", "False"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"process", ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"makeProcesses", "[", 
               RowBox[{"-", 
                RowBox[{"F", "[", "1", "]"}]}], "]"}], "]"}]}], "}"}]}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"_", "->", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"setting", " ", "masses", " ", "to", " ", "zero"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"fermion0", "=", 
    RowBox[{"fermion", "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"TheMass", ",", "particleTypes"}], "]"}], "->", "0"}], 
      "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.935729879173848*^9, 3.9357299010628633`*^9}, {
  3.935730046413553*^9, 3.935730068037894*^9}, {3.935751399762532*^9, 
  3.9357514277607183`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"b62f52a3-4354-4a41-8e77-ac78a92c1f2e"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"], " ", 
         SuperscriptBox["y", "2"]}], "u"]}], "-", 
      FractionBox[
       RowBox[{"2", " ", "t", " ", 
        SuperscriptBox["y", "4"]}], "s"], "-", 
      FractionBox[
       RowBox[{"2", " ", "s", " ", 
        SuperscriptBox["y", "4"]}], "t"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"], " ", 
         SuperscriptBox["y", "2"]}], "t"]}], "-", 
      FractionBox[
       RowBox[{"2", " ", "u", " ", 
        SuperscriptBox["y", "4"]}], "s"], "-", 
      FractionBox[
       RowBox[{"2", " ", "s", " ", 
        SuperscriptBox["y", "4"]}], "u"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], ")"}], "\[Rule]", 
     RowBox[{"12", " ", 
      SuperscriptBox["y", "4"]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"1", ",", "2", ",", "0", ",", "0"}], ")"}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["y", "2"]}], "s"], "+", 
      FractionBox[
       RowBox[{"2", " ", "u", " ", 
        SuperscriptBox["y", "4"]}], "t"], "+", 
      FractionBox[
       RowBox[{"2", " ", "t", " ", 
        SuperscriptBox["y", "4"]}], "u"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"1", ",", "2", ",", "1", ",", "2"}], ")"}], "\[Rule]", 
     RowBox[{"12", " ", 
      SuperscriptBox["y", "4"]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"1", ",", "2", ",", "2", ",", "1"}], ")"}], "\[Rule]", 
     RowBox[{"12", " ", 
      SuperscriptBox["y", "4"]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"2", ",", "0", ",", "0", ",", "2"}], ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"], " ", 
         SuperscriptBox["y", "2"]}], "u"]}], "-", 
      FractionBox[
       RowBox[{"2", " ", "t", " ", 
        SuperscriptBox["y", "4"]}], "s"], "-", 
      FractionBox[
       RowBox[{"2", " ", "s", " ", 
        SuperscriptBox["y", "4"]}], "t"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"2", ",", "0", ",", "2", ",", "0"}], ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"], " ", 
         SuperscriptBox["y", "2"]}], "t"]}], "-", 
      FractionBox[
       RowBox[{"2", " ", "u", " ", 
        SuperscriptBox["y", "4"]}], "s"], "-", 
      FractionBox[
       RowBox[{"2", " ", "s", " ", 
        SuperscriptBox["y", "4"]}], "u"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0"}], ")"}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["y", "2"]}], "s"], "+", 
      FractionBox[
       RowBox[{"2", " ", "u", " ", 
        SuperscriptBox["y", "4"]}], "t"], "+", 
      FractionBox[
       RowBox[{"2", " ", "t", " ", 
        SuperscriptBox["y", "4"]}], "u"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "4"]}]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"2", ",", "1", ",", "1", ",", "2"}], ")"}], "\[Rule]", 
     RowBox[{"12", " ", 
      SuperscriptBox["y", "4"]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"2", ",", "1", ",", "2", ",", "1"}], ")"}], "\[Rule]", 
     RowBox[{"12", " ", 
      SuperscriptBox["y", "4"]}]}], ",", 
    RowBox[{
     RowBox[{"M", "(", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], ")"}], "\[Rule]", 
     RowBox[{"12", " ", 
      SuperscriptBox["y", "4"]}]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.935730520563689*^9, 3.935739800639162*^9, {3.935751417737624*^9, 
   3.935751433379691*^9}, 3.935751705890675*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"a9bdb6ab-c24f-4f94-ace7-72c9ce10bdcf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"results", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"scalar0", ",", "fermion0"}], "}"}], ",", "1"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.929416772808609*^9, 3.9294167805885353`*^9}, {
  3.929416925633687*^9, 3.929416959906736*^9}, {3.929417274791964*^9, 
  3.929417333386627*^9}, {3.929417539582031*^9, 3.929417548329384*^9}, {
  3.929418329788625*^9, 3.929418344442057*^9}, {3.929418485354183*^9, 
  3.929418486376028*^9}, {3.930134041480267*^9, 3.930134041802174*^9}, {
  3.934350716620966*^9, 3.93435072026768*^9}, {3.935730185690373*^9, 
  3.935730193389427*^9}, {3.935751432367298*^9, 3.9357514474527617`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"b4a94ef0-1c71-4c37-8192-9df467c3a489"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"results", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.930134073300818*^9, 3.93013410514918*^9}, {
  3.934350708823621*^9, 3.934350711235441*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"34b3076e-af96-4cb9-8c14-d758ef1b3e73"],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"(", "\[NoBreak]", 
    TagBox[GridBox[{
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], ")"}], "\[Rule]", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["g", "4"], " ", 
            SuperscriptBox["u", "2"]}], 
           RowBox[{
            SuperscriptBox["s", "2"], " ", 
            SuperscriptBox["t", "2"]}]], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["g", "4"], " ", 
            SuperscriptBox["t", "2"]}], 
           RowBox[{
            SuperscriptBox["s", "2"], " ", 
            SuperscriptBox["u", "2"]}]], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["g", "4"], " ", "u"}], 
           RowBox[{
            SuperscriptBox["s", "2"], " ", "t"}]], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["g", "4"], " ", "t"}], 
           RowBox[{
            SuperscriptBox["s", "2"], " ", "u"}]], "+", 
          FractionBox[
           RowBox[{"3", " ", 
            SuperscriptBox["g", "4"]}], 
           SuperscriptBox["s", "2"]], "-", 
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", "lam", " ", "u"}], 
           RowBox[{"s", " ", "t"}]], "-", 
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", "lam", " ", "t"}], 
           RowBox[{"s", " ", "u"}]], "-", 
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", "lam"}], "s"], "+", 
          SuperscriptBox["lam", "2"]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "2"}], ")"}], "\[Rule]", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["y", "2"]}], "s"], "+", 
          FractionBox[
           RowBox[{"2", " ", "u", " ", 
            SuperscriptBox["y", "4"]}], "t"], "+", 
          FractionBox[
           RowBox[{"2", " ", "t", " ", 
            SuperscriptBox["y", "4"]}], "u"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "1"}], ")"}], "\[Rule]", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["y", "2"]}], "s"], "+", 
          FractionBox[
           RowBox[{"2", " ", "u", " ", 
            SuperscriptBox["y", "4"]}], "t"], "+", 
          FractionBox[
           RowBox[{"2", " ", "t", " ", 
            SuperscriptBox["y", "4"]}], "u"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["y", "2"]}], "t"]}], "-", 
          FractionBox[
           RowBox[{"2", " ", "u", " ", 
            SuperscriptBox["y", "4"]}], "s"], "-", 
          FractionBox[
           RowBox[{"2", " ", "s", " ", 
            SuperscriptBox["y", "4"]}], "u"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"0", ",", "1", ",", "1", ",", "0"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["y", "2"]}], "u"]}], "-", 
          FractionBox[
           RowBox[{"2", " ", "t", " ", 
            SuperscriptBox["y", "4"]}], "s"], "-", 
          FractionBox[
           RowBox[{"2", " ", "s", " ", 
            SuperscriptBox["y", "4"]}], "t"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "2"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["y", "2"]}], "t"]}], "-", 
          FractionBox[
           RowBox[{"2", " ", "u", " ", 
            SuperscriptBox["y", "4"]}], "s"], "-", 
          FractionBox[
           RowBox[{"2", " ", "s", " ", 
            SuperscriptBox["y", "4"]}], "u"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"0", ",", "2", ",", "2", ",", "0"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["y", "2"]}], "u"]}], "-", 
          FractionBox[
           RowBox[{"2", " ", "t", " ", 
            SuperscriptBox["y", "4"]}], "s"], "-", 
          FractionBox[
           RowBox[{"2", " ", "s", " ", 
            SuperscriptBox["y", "4"]}], "t"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "1"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["y", "2"]}], "u"]}], "-", 
          FractionBox[
           RowBox[{"2", " ", "t", " ", 
            SuperscriptBox["y", "4"]}], "s"], "-", 
          FractionBox[
           RowBox[{"2", " ", "s", " ", 
            SuperscriptBox["y", "4"]}], "t"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["y", "2"]}], "t"]}], "-", 
          FractionBox[
           RowBox[{"2", " ", "u", " ", 
            SuperscriptBox["y", "4"]}], "s"], "-", 
          FractionBox[
           RowBox[{"2", " ", "s", " ", 
            SuperscriptBox["y", "4"]}], "u"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1"}], ")"}], "\[Rule]", 
         RowBox[{"12", " ", 
          SuperscriptBox["y", "4"]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"1", ",", "2", ",", "0", ",", "0"}], ")"}], "\[Rule]", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["y", "2"]}], "s"], "+", 
          FractionBox[
           RowBox[{"2", " ", "u", " ", 
            SuperscriptBox["y", "4"]}], "t"], "+", 
          FractionBox[
           RowBox[{"2", " ", "t", " ", 
            SuperscriptBox["y", "4"]}], "u"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"1", ",", "2", ",", "1", ",", "2"}], ")"}], "\[Rule]", 
         RowBox[{"12", " ", 
          SuperscriptBox["y", "4"]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"1", ",", "2", ",", "2", ",", "1"}], ")"}], "\[Rule]", 
         RowBox[{"12", " ", 
          SuperscriptBox["y", "4"]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "2"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["y", "2"]}], "u"]}], "-", 
          FractionBox[
           RowBox[{"2", " ", "t", " ", 
            SuperscriptBox["y", "4"]}], "s"], "-", 
          FractionBox[
           RowBox[{"2", " ", "s", " ", 
            SuperscriptBox["y", "4"]}], "t"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"2", ",", "0", ",", "2", ",", "0"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["y", "2"]}], "t"]}], "-", 
          FractionBox[
           RowBox[{"2", " ", "u", " ", 
            SuperscriptBox["y", "4"]}], "s"], "-", 
          FractionBox[
           RowBox[{"2", " ", "s", " ", 
            SuperscriptBox["y", "4"]}], "u"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"2", ",", "1", ",", "0", ",", "0"}], ")"}], "\[Rule]", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["y", "2"]}], "s"], "+", 
          FractionBox[
           RowBox[{"2", " ", "u", " ", 
            SuperscriptBox["y", "4"]}], "t"], "+", 
          FractionBox[
           RowBox[{"2", " ", "t", " ", 
            SuperscriptBox["y", "4"]}], "u"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "4"]}]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"2", ",", "1", ",", "1", ",", "2"}], ")"}], "\[Rule]", 
         RowBox[{"12", " ", 
          SuperscriptBox["y", "4"]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"2", ",", "1", ",", "2", ",", "1"}], ")"}], "\[Rule]", 
         RowBox[{"12", " ", 
          SuperscriptBox["y", "4"]}]}]},
       {
        RowBox[{
         RowBox[{"M", "(", 
          RowBox[{"2", ",", "2", ",", "2", ",", "2"}], ")"}], "\[Rule]", 
         RowBox[{"12", " ", 
          SuperscriptBox["y", "4"]}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.5599999999999999]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     Column], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.9301340717598*^9, 3.930134105541143*^9}, 
   3.930281988086487*^9, 3.93313201360319*^9, 3.933825194168874*^9, 
   3.934340582926132*^9, {3.934350712107908*^9, 3.934350733701213*^9}, {
   3.935743465151105*^9, 3.935743470203499*^9}, 3.9357442643959837`*^9, {
   3.935751443265834*^9, 3.935751449802107*^9}, 3.9357517059560423`*^9},
 CellLabel->
  "Out[31]//MatrixForm=",ExpressionUUID->"7df88f7b-d248-40e0-927b-\
1490853015fd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"feynAssociation", "=", 
   RowBox[{"Association", "[", "results", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9294197937861958`*^9, 3.929419818160491*^9}, {
   3.930134122770121*^9, 3.930134123651985*^9}, 3.9343507384952717`*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"57e50ffd-0fbd-4f85-a681-760b6b852afc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting to JSON", "Chapter",
 CellChangeTimes->{{3.9338252493010902`*^9, 3.9338252630058727`*^9}, {
  3.9357517230971746`*^9, 
  3.935751725836915*^9}},ExpressionUUID->"452cb467-c2cb-407d-be2d-\
f1613589c6bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"writing", " ", "as", " ", "JSON"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"makeJsonObject", "[", 
     RowBox[{"fields_", ",", "parameters_", ",", "results_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fieldsJson", ",", "matrixElementsJson", ",", "toString", ",", 
        "getRelevantParameters", ",", "replaceSpecials"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "construct", " ", "an", " ", "object", " ", "which", " ", "can", " ", 
        "then", " ", "be", " ", "exported", " ", "to", " ", "JSON"}], "*)"}], 
      
      RowBox[{
       RowBox[{
        RowBox[{"toString", "[", "arg_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringQ", "[", "arg", "]"}], ",", "arg", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"arg", ",", "InputForm"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"replaceSpecials", "[", "arg_", "]"}], ":=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"arg", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Pi\>\"", "->", "\"\<_pi\>\""}], ",", 
            RowBox[{"\"\<s\>\"", "->", "\"\<_s\>\""}], ",", 
            RowBox[{"\"\<t\>\"", "->", "\"\<_t\>\""}], ",", 
            RowBox[{"\"\<u\>\"", "->", "\"\<_u\>\""}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getRelevantParameters", "[", "arg_", "]"}], ":=", 
        RowBox[{"Select", "[", 
         RowBox[{"parameters", ",", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"arg", ",", "#"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fieldsJson", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<index\>\"", "->", 
             RowBox[{"i", "-", "1"}]}], ",", 
            RowBox[{"\"\<name\>\"", "->", 
             RowBox[{"toString", "[", 
              RowBox[{"fields", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "fields", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"matrixElementsJson", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<externalParticles\>\"", "->", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
              RowBox[{
               RowBox[{"M", "[", "a__", "]"}], "->", 
               RowBox[{"List", "[", "a", "]"}]}]}], ",", 
             RowBox[{"\"\<parameters\>\"", "->", 
              RowBox[{"Map", "[", 
               RowBox[{"toString", ",", 
                RowBox[{"getRelevantParameters", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"\"\<expression\>\"", "->", 
              RowBox[{"replaceSpecials", "[", 
               RowBox[{"toString", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]}], "}"}], 
           "&"}], ",", "results"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<particles\>\"", "->", "fieldsJson"}], ",", 
          RowBox[{"\"\<matrixElements\>\"", "->", "matrixElementsJson"}]}], 
         "}"}], "]"}]}]}], "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"here", " ", "for", " ", "the", " ", "Yukawa", " ", "model"}], 
     ",", 
     RowBox[{
     "where", " ", "the", " ", "matrix", " ", "elements", " ", "are", " ", 
      "stored", " ", "in", " ", "the", " ", "object", " ", "called", " ", 
      "MatrixElements"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toExportAsJSON", "=", 
     RowBox[{"makeJsonObject", "[", 
      RowBox[{"particleNames", ",", "parameters", ",", 
       RowBox[{"results", "//", "SMPToSymbol"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"model", ",", "\"\<.json\>\""}], "]"}]}], "}"}], "]"}], ",",
       "toExportAsJSON"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.93551856771027*^9, 3.935518600269931*^9}, 
   3.935519193679269*^9, {3.935519231779974*^9, 3.935519309251521*^9}, 
   3.935519474917756*^9, {3.935519551363652*^9, 3.935519576988494*^9}, {
   3.935520329044094*^9, 3.935520338217939*^9}, 3.935520417354196*^9, {
   3.935520492459708*^9, 3.935520640942428*^9}, {3.935524439084268*^9, 
   3.935524441306099*^9}, 3.935524559557236*^9, {3.935743573885497*^9, 
   3.9357435755025663`*^9}, {3.935743729401927*^9, 3.935743734912713*^9}, {
   3.935743836587569*^9, 3.9357438366490293`*^9}, {3.935744451429291*^9, 
   3.935744454312519*^9}, {3.9357446685860043`*^9, 3.935744669645329*^9}, {
   3.935744741779169*^9, 3.9357447586691318`*^9}, {3.935744958872927*^9, 
   3.935745025028075*^9}, {3.935745258499324*^9, 3.935745258665791*^9}, 
   3.935751728373632*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"cfafe2d1-2b15-4a67-8477-466a799bc985"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1728, 1027},
WindowMargins->{{46, Automatic}, {Automatic, -1002}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
CommonDefaultFormatTypes->{"Output"->TraditionalForm},
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "14.0 for Mac OS X ARM (64-bit) (December 12, 2023)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"965dcbbb-f472-4bad-b3e2-9315bea466b8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 467, 7, 98, "Title",ExpressionUUID->"64705e10-4319-45ae-8006-0f7fed9a3ce6"],
Cell[CellGroupData[{
Cell[1072, 33, 163, 3, 69, "Chapter",ExpressionUUID->"75bede65-65f5-4df8-8be5-8763376545fa"],
Cell[CellGroupData[{
Cell[1260, 40, 1359, 26, 94, "Input",ExpressionUUID->"5033f070-340c-4a47-af38-98cf26302691"],
Cell[CellGroupData[{
Cell[2644, 70, 6532, 136, 30, "Print",ExpressionUUID->"1727780b-2ff4-4b53-b6ad-4ee7bc7618c3"],
Cell[9179, 208, 3163, 47, 27, "Print",ExpressionUUID->"0447ef80-4965-4dbb-873d-162ed5bfd309"],
Cell[12345, 257, 3207, 49, 27, "Print",ExpressionUUID->"fd5978ce-bde4-442d-864c-254e91c84596"],
Cell[15555, 308, 4811, 96, 30, "Print",ExpressionUUID->"a2c86c7b-bf58-4550-bd66-baffcc103459"],
Cell[20369, 406, 3099, 46, 27, "Print",ExpressionUUID->"7f777727-6b04-47a0-b39a-b242a66380c7"],
Cell[23471, 454, 3134, 47, 27, "Print",ExpressionUUID->"3a29860f-b4a8-463e-8594-dda929423e62"]
}, Open  ]]
}, Open  ]],
Cell[26632, 505, 399, 8, 52, "Input",ExpressionUUID->"02f92399-fcbe-4bc1-9117-792392e1d5c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27068, 518, 159, 3, 69, "Chapter",ExpressionUUID->"f5b17365-e344-4951-a8bf-682379c5dff6"],
Cell[27230, 523, 1511, 34, 115, "Input",ExpressionUUID->"f40b35fa-4a17-4c6c-b392-b40cd7767db7"],
Cell[CellGroupData[{
Cell[28766, 561, 2476, 60, 94, "Input",ExpressionUUID->"5ebc72a0-de0d-43df-83e8-50a95768348a"],
Cell[31245, 623, 464, 9, 30, "Output",ExpressionUUID->"fa90964d-6141-4975-bd52-98f36035d7e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31746, 637, 628, 16, 73, "Input",ExpressionUUID->"df2f9d8f-c63f-4724-81dc-18372eea0a54"],
Cell[32377, 655, 352, 7, 30, "Output",ExpressionUUID->"47224435-695a-43b2-bf36-db5752b24159"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32766, 667, 1379, 37, 94, "Input",ExpressionUUID->"23039e3d-3c71-4845-88f7-37037ba7ce4d"],
Cell[34148, 706, 808, 19, 30, "Output",ExpressionUUID->"0d390b9d-6b87-40b8-84c5-93a26d80e869"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35005, 731, 218, 4, 69, "Chapter",ExpressionUUID->"49004534-9081-4e18-af70-0f8568b2a3a5"],
Cell[35226, 737, 1900, 45, 94, "Input",ExpressionUUID->"e19637cd-9246-483f-9865-9af615165b4a"],
Cell[37129, 784, 5997, 117, 451, "Input",ExpressionUUID->"8680e620-c5fd-4647-b023-22fc997a15a9"],
Cell[43129, 903, 7543, 152, 409, "Input",ExpressionUUID->"c63ce969-75cd-4863-abef-d2197a5b96a6"],
Cell[CellGroupData[{
Cell[50697, 1059, 2659, 53, 136, "Input",ExpressionUUID->"727254a6-a14c-4fb9-a9bd-ca992ffc33ec"],
Cell[53359, 1114, 6724, 174, 96, "Output",ExpressionUUID->"6dd3c206-3f36-48d0-b588-9a0767f05e73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60120, 1293, 2285, 55, 199, "Input",ExpressionUUID->"b62f52a3-4354-4a41-8e77-ac78a92c1f2e"],
Cell[62408, 1350, 4629, 137, 94, "Output",ExpressionUUID->"a9bdb6ab-c24f-4f94-ace7-72c9ce10bdcf"]
}, Open  ]],
Cell[67052, 1490, 782, 15, 30, "Input",ExpressionUUID->"b4a94ef0-1c71-4c37-8192-9df467c3a489"],
Cell[CellGroupData[{
Cell[67859, 1509, 258, 4, 30, "Input",ExpressionUUID->"34b3076e-af96-4cb9-8c14-d758ef1b3e73"],
Cell[68120, 1515, 11194, 317, 534, "Output",ExpressionUUID->"7df88f7b-d248-40e0-927b-1490853015fd"]
}, Open  ]],
Cell[79329, 1835, 347, 6, 30, "Input",ExpressionUUID->"57e50ffd-0fbd-4f85-a681-760b6b852afc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79713, 1846, 217, 4, 69, "Chapter",ExpressionUUID->"452cb467-c2cb-407d-be2d-f1613589c6bd"],
Cell[79933, 1852, 5594, 130, 271, "Input",ExpressionUUID->"cfafe2d1-2b15-4a67-8477-466a799bc985"]
}, Open  ]]
}, Open  ]]
}
]
*)

