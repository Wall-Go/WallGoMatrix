(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     83856,       1793]
NotebookOptionsPosition[     80142,       1721]
NotebookOutlinePosition[     80901,       1744]
CellTagsIndexPosition[     80858,       1741]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Matrix elements  in a n-scalar model", "Title",
 CellChangeTimes->{{3.845372694159729*^9, 3.845372707741476*^9}, {
   3.845995748126807*^9, 3.845995748301729*^9}, {3.8773539549102507`*^9, 
   3.87735396762534*^9}, {3.929073978083912*^9, 3.92907397972012*^9}, {
   3.933870405451301*^9, 3.9338704081335278`*^9}, {3.934861950081461*^9, 
   3.934861954340464*^9}, {3.935751079272887*^9, 3.935751081431068*^9}, {
   3.947049521787986*^9, 3.947049523662506*^9}, 
   3.947052844298407*^9},ExpressionUUID->"64705e10-4319-45ae-8006-\
0f7fed9a3ce6"],

Cell[CellGroupData[{

Cell["Loading packages", "Chapter",
 CellChangeTimes->{{3.8438364813982077`*^9, 
  3.843836483762822*^9}},ExpressionUUID->"75bede65-65f5-4df8-8be5-\
8763376545fa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$LoadAddOns", "=", 
   RowBox[{"{", "\"\<FeynArts\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<FeynCalc`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FAVerbose", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"FourVector", ",", 
    RowBox[{"FeynCalcInternal", "\[Rule]", "False"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.843795906798201*^9, 3.843795911191774*^9}, {
   3.843795976577758*^9, 3.843795977170793*^9}, {3.843796498335074*^9, 
   3.843796498693701*^9}, {3.843798973992594*^9, 3.843799009718174*^9}, {
   3.84380120162346*^9, 3.843801201967709*^9}, {3.8438024360567923`*^9, 
   3.843802482327758*^9}, {3.845438834150241*^9, 3.8454388505337973`*^9}, {
   3.84543890855401*^9, 3.845438909449184*^9}, 3.845984626474794*^9, 
   3.878104035582633*^9, {3.878104076493684*^9, 3.8781040774004602`*^9}, {
   3.878104364445066*^9, 3.878104364655937*^9}, {3.878104742641322*^9, 
   3.878104742887733*^9}, 3.929073984368247*^9, {3.934346112007848*^9, 
   3.934346121442477*^9}, {3.935645983391458*^9, 3.935645998835178*^9}, {
   3.935646049969775*^9, 3.935646050373325*^9}, {3.935750723745977*^9, 
   3.935750724799377*^9}},
 CellLabel->
  "(Local) In[1]:=",ExpressionUUID->"5033f070-340c-4a47-af38-98cf26302691"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"FeynCalc \"\>", "Text",
     StripOnInput->False,
     FontWeight->Bold], "\[InvisibleSpace]", 
    StyleBox["\<\"10.0.0 (dev version). For help, use the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{
        RowBox[{"online", " ", "documentation"}], ","}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["https://feyncalc.github.io/referenceDev"], None},
       ButtonNote->"https://feyncalc.github.io/referenceDev"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" visit the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["forum",
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["https://github.com/FeynCalc/feyncalc/discussions"], None},
       ButtonNote->"https://github.com/FeynCalc/feyncalc/discussions/"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" and have a look at the supplied \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"examples", "."}],
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" The PDF-version of the manual can be downloaded \"\>", 
     "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"here", "."}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL[
         "https://github.com/FeynCalc/feyncalc-manual/releases/download/dev-\
manual/FeynCalcManual.pdf"], None},
       ButtonNote->
        "https://github.com/FeynCalc/feyncalc-manual/releases/download/dev-\
manual/FeynCalcManual.pdf"],
      DisplayForm], "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["FeynCalc ", "Text", Bold], 
    Style["10.0.0 (dev version). For help, use the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["online documentation,", ButtonData :> {
         URL["https://feyncalc.github.io/referenceDev"], None}, BaseStyle -> 
       "Hyperlink", ButtonNote -> "https://feyncalc.github.io/referenceDev"]],
      "Text"], 
    Style[" visit the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["forum", ButtonData :> {
         URL["https://github.com/FeynCalc/feyncalc/discussions"], None}, 
       BaseStyle -> "Hyperlink", ButtonNote -> 
       "https://github.com/FeynCalc/feyncalc/discussions/"]], "Text"], 
    Style[" and have a look at the supplied ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "examples.", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]], Evaluator -> 
       Automatic, Method -> "Preemptive"]], "Text"], 
    Style[" The PDF-version of the manual can be downloaded ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["here.", ButtonData :> {
         URL[
         "https://github.com/FeynCalc/feyncalc-manual/releases/download/dev-\
manual/FeynCalcManual.pdf"], None}, BaseStyle -> "Hyperlink", ButtonNote -> 
       "https://github.com/FeynCalc/feyncalc-manual/releases/download/dev-\
manual/FeynCalcManual.pdf"]], "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.93575070883695*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614802294*^9, 
   3.9364324309452457`*^9, {3.947052848594993*^9, 3.9470528605072412`*^9}, 
   3.947053155916787*^9, 3.947053317237501*^9, 3.947053647755144*^9, 
   3.9470538438454638`*^9, 3.9470543725587053`*^9, 3.947062752264133*^9},
 CellLabel->
  "During evaluation of (Local) \
In[1]:=",ExpressionUUID->"bc28932f-1056-4c36-9655-c7a4266ed275"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"If you use FeynCalc in your research, please evaluate \
FeynCalcHowToCite[] to learn how to cite this software.\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.93575070883695*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614802294*^9, 
   3.9364324309452457`*^9, {3.947052848594993*^9, 3.9470528605072412`*^9}, 
   3.947053155916787*^9, 3.947053317237501*^9, 3.947053647755144*^9, 
   3.9470538438454638`*^9, 3.9470543725587053`*^9, 3.947062752265356*^9},
 CellLabel->
  "During evaluation of (Local) \
In[1]:=",ExpressionUUID->"3ebf1cd5-729f-482a-b356-a0f634462ed2"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"Please keep in mind that the proper academic attribution of \
our work is crucial to ensure the future development of this package!\"\>", 
   "Text",
   StripOnInput->False,
   FontSlant->Italic], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.93575070883695*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614802294*^9, 
   3.9364324309452457`*^9, {3.947052848594993*^9, 3.9470528605072412`*^9}, 
   3.947053155916787*^9, 3.947053317237501*^9, 3.947053647755144*^9, 
   3.9470538438454638`*^9, 3.9470543725587053`*^9, 3.947062752265629*^9},
 CellLabel->
  "During evaluation of (Local) \
In[1]:=",ExpressionUUID->"9b9ef866-ea74-41af-9cc6-0be83f302c80"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "SetDelayed", "wrsym", 
    "\"Symbol \\!\\(\\*FormBox[\\\"Discard\\\", TraditionalForm]\\) is \
Protected.\"", 2, 2, 1, 32636954193803953716, "Local"},
   "MessageTemplate",
   BaseStyle->"MSG"], TraditionalForm]], "Message",
 CellChangeTimes->{{3.947052846221593*^9, 3.94705286054091*^9}, 
   3.947053155956545*^9, 3.947053317271017*^9, 3.947053647791664*^9, 
   3.947053843880176*^9, 3.947054372592285*^9, 3.947062752315592*^9},
 CellLabel->
  "During evaluation of (Local) \
In[1]:=",ExpressionUUID->"057ad9bf-cfee-409a-8ba5-d04591f6efcd"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"FeynArts \"\>", "Text",
     StripOnInput->False,
     FontWeight->Bold], "\[InvisibleSpace]", 
    StyleBox["\<\"3.11 (25 Mar 2022) patched for use with FeynCalc, for \
documentation see the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["manual",
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         First[
          FileNames[{"*.pdf", "*.PDF"}, 
           FileNameJoin[{FeynCalc`$FeynArtsDirectory, "manual"}]]]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" or visit \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"www", ".", "feynarts", ".", "de", "."}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["http://www.feynarts.de/"], None},
       ButtonNote->"www.feynarts.de/"],
      DisplayForm], "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["FeynArts ", "Text", Bold], 
    Style[
    "3.11 (25 Mar 2022) patched for use with FeynCalc, for documentation see \
the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "manual", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         First[
          FileNames[{"*.pdf", "*.PDF"}, 
           FileNameJoin[{FeynCalc`$FeynArtsDirectory, "manual"}]]]], 
       Evaluator -> Automatic, Method -> "Preemptive"]], "Text"], 
    Style[" or visit ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["www.feynarts.de.", ButtonData :> {
         URL["http://www.feynarts.de/"], None}, BaseStyle -> "Hyperlink", 
       ButtonNote -> "www.feynarts.de/"]], "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.93575070883695*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614802294*^9, 
   3.9364324309452457`*^9, {3.947052848594993*^9, 3.9470528605072412`*^9}, 
   3.947053155916787*^9, 3.947053317237501*^9, 3.947053647755144*^9, 
   3.9470538438454638`*^9, 3.9470543725587053`*^9, 3.9470627523644876`*^9},
 CellLabel->
  "During evaluation of (Local) \
In[1]:=",ExpressionUUID->"dbc116c5-808b-4525-8cec-9a4d2248e362"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"If you use FeynArts in your research, please cite\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.93575070883695*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614802294*^9, 
   3.9364324309452457`*^9, {3.947052848594993*^9, 3.9470528605072412`*^9}, 
   3.947053155916787*^9, 3.947053317237501*^9, 3.947053647755144*^9, 
   3.9470538438454638`*^9, 3.9470543725587053`*^9, 3.94706275236493*^9},
 CellLabel->
  "During evaluation of (Local) \
In[1]:=",ExpressionUUID->"d561f5d9-f406-46a3-90de-96aed79a0eb8"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\" \[Bullet] T. Hahn, Comput. Phys. Commun., 140, 418-431, \
2001, arXiv:hep-ph/0012260\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.843798996872006*^9, 3.8437989999994783`*^9}, 
   3.843801227258348*^9, 3.843801935980476*^9, {3.843802282880822*^9, 
   3.843802292431467*^9}, 3.843802404177596*^9, {3.843802461868064*^9, 
   3.843802487019228*^9}, 3.8438186628711*^9, 3.84383582080438*^9, 
   3.843840073319666*^9, 3.844874082376369*^9, {3.844929119851939*^9, 
   3.84492914383794*^9}, 3.844929267561232*^9, 3.844932131968658*^9, 
   3.8449378492956676`*^9, 3.845370145745384*^9, 3.845373419518979*^9, 
   3.845373461495468*^9, 3.845438920819323*^9, 3.8454449493214493`*^9, 
   3.845631324885903*^9, 3.8456316042204742`*^9, 3.845631679679163*^9, 
   3.845631964324121*^9, 3.845632513810188*^9, 3.845984629483571*^9, 
   3.845991503133749*^9, 3.8459919837094603`*^9, 3.845992427388056*^9, 
   3.845993690163274*^9, 3.845994905333474*^9, 3.846046865111197*^9, 
   3.846050431236582*^9, 3.8460520168215637`*^9, 3.846053424627554*^9, 
   3.846061506883589*^9, 3.846066710664327*^9, 3.846129935619287*^9, 
   3.846130960575139*^9, 3.846133265801556*^9, 3.846151456974696*^9, 
   3.846153098266497*^9, 3.846155399379522*^9, 3.846164227415817*^9, 
   3.846243485722616*^9, 3.850466367903163*^9, 3.850473198617125*^9, 
   3.8505361971728783`*^9, 3.850538417861948*^9, 3.850538622406764*^9, 
   3.850541029162965*^9, 3.850549155394509*^9, 3.850549451616798*^9, 
   3.850550651400634*^9, 3.850552532655553*^9, 3.850826832034655*^9, 
   3.8508328409300413`*^9, 3.850835238015671*^9, 3.850840110094518*^9, 
   3.850915690422765*^9, 3.851010482610511*^9, 3.851162250007274*^9, 
   3.8511882625222883`*^9, 3.851251340657913*^9, 3.851275022038113*^9, 
   3.877163564778455*^9, 3.877170358644658*^9, 3.8773541032639713`*^9, 
   3.87810358771602*^9, {3.878104038054556*^9, 3.87810408863923*^9}, 
   3.878104761724121*^9, 3.878105461729494*^9, 3.878106066896067*^9, 
   3.87819348023136*^9, 3.9290739917139187`*^9, {3.929090455875965*^9, 
   3.929090471973406*^9}, 3.929163058042454*^9, 3.929165228909963*^9, 
   3.929207104943245*^9, {3.929416572865543*^9, 3.929416594915186*^9}, 
   3.929418685845803*^9, 3.92941969507587*^9, 3.929419730411253*^9, 
   3.92943627896874*^9, {3.929517774876457*^9, 3.929517790315604*^9}, 
   3.9295327842797422`*^9, 3.92959352227103*^9, 3.929603693220842*^9, {
   3.929606917279559*^9, 3.929606925416741*^9}, 3.9297018798678083`*^9, 
   3.929792582223654*^9, 3.930123080159695*^9, 3.930281982286295*^9, 
   3.933132007784498*^9, 3.9338251882562437`*^9, 3.933870419329222*^9, 
   3.934101821850534*^9, 3.934340577519391*^9, 3.934346180475981*^9, 
   3.93486195941438*^9, 3.935637117795123*^9, 3.935645251683629*^9, {
   3.935645999249716*^9, 3.935646008958559*^9}, 3.9356460518902903`*^9, 
   3.935727382248142*^9, 3.935735973154376*^9, {3.93575070883695*^9, 
   3.935750725306916*^9}, 3.9357512316348677`*^9, 3.935751614802294*^9, 
   3.9364324309452457`*^9, {3.947052848594993*^9, 3.9470528605072412`*^9}, 
   3.947053155916787*^9, 3.947053317237501*^9, 3.947053647755144*^9, 
   3.9470538438454638`*^9, 3.9470543725587053`*^9, 3.947062752365839*^9},
 CellLabel->
  "During evaluation of (Local) \
In[1]:=",ExpressionUUID->"b7d17920-1cb4-402d-8306-1a1dbe22b49b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Choosing model", "Chapter",
 CellChangeTimes->{{3.846050434940159*^9, 
  3.846050436476512*^9}},ExpressionUUID->"f5b17365-e344-4951-a8bf-\
682379c5dff6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "is", " ", "where", " ", "the", " ", "FeynArts", " ", 
     "files", " ", "made", " ", "by", " ", "FeynRules", " ", "can", " ", "be",
      " ", "found"}], ",", " ", 
    RowBox[{"ending", " ", 
     RowBox[{"in", " ", ".", "gen"}], " ", 
     RowBox[{"and", " ", ".", "mod"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"model", "=", "\"\<n-scalars\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modLoc", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "model"}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"genericLoc", "=", "modLoc"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitializeModel", "[", 
     RowBox[{"modLoc", ",", 
      RowBox[{"GenericModel", "->", "modLoc"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.933870596031344*^9, {3.934346514065029*^9, 3.934346515479988*^9}, {
   3.934862066924714*^9, 3.934862095258631*^9}, {3.935637720444118*^9, 
   3.935637745481882*^9}, 3.9356452532929363`*^9, {3.935648756824701*^9, 
   3.935648767149409*^9}, {3.935743484834828*^9, 3.935743491507557*^9}, {
   3.935750418482268*^9, 3.935750419124872*^9}, {3.935750452389639*^9, 
   3.93575047458*^9}, {3.935750628286405*^9, 3.935750643961434*^9}, {
   3.936432462934297*^9, 3.936432464920457*^9}, {3.947049516796056*^9, 
   3.947049519532394*^9}, {3.947052862358942*^9, 3.947052863421125*^9}},
 CellLabel->
  "(Local) In[5]:=",ExpressionUUID->"f40b35fa-4a17-4c6c-b392-b40cd7767db7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "relevant", " ", "processes", " ", "for", " ", "Boltzmann", " ", 
    "collision", " ", "integrals", " ", "with", " ", "given", " ", "particle",
     " ", "in", " ", "position", " ", "p1"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"particleTypes", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"F$Particles", ",", 
       RowBox[{
        RowBox[{"U", "[", "1", "]"}], "|", 
        RowBox[{"-", 
         RowBox[{"U", "[", "1", "]"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"particleNames", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"TheLabel", "[", "#", "]"}], "]"}], "<>", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "Times"}], 
          ",", "\"\<bar\>\"", ",", "\"\<\>\""}], "]"}]}], "&"}], ",", 
      "particleTypes"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeProcesses", "[", "firstParticle_", "]"}], ":=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"firstParticle", ",", "a"}], "}"}], "->", 
           RowBox[{"{", 
            RowBox[{"b", ",", "c"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "particleTypes"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "particleTypes"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "particleTypes"}], "}"}]}], "]"}], ",", "2"}], 
       "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.929163473923676*^9, 3.929163498308498*^9}, {
   3.933870450444408*^9, 3.933870492654088*^9}, {3.933870524985799*^9, 
   3.933870525413417*^9}, {3.934862117286737*^9, 3.934862198838484*^9}, {
   3.934862661988862*^9, 3.934862817762034*^9}, {3.934862853627457*^9, 
   3.934862856412826*^9}, {3.934863230814647*^9, 3.934863262468681*^9}, {
   3.935637237364757*^9, 3.935637240473458*^9}, {3.935728360482558*^9, 
   3.935728364456549*^9}, {3.935728623070777*^9, 3.935728637279348*^9}, {
   3.935728855665764*^9, 3.9357289126182127`*^9}, {3.93572894276196*^9, 
   3.935728959897721*^9}, 3.935750676733197*^9},
 CellLabel->
  "(Local) In[9]:=",ExpressionUUID->"5ebc72a0-de0d-43df-83e8-50a95768348a"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"Phi[1]\"\>", ",", "\<\"Phi[2]\"\>", ",", "\<\"Phi[3]\"\>"}], 
   "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.935728888385016*^9, 3.935728914446125*^9}, {
   3.935728956700542*^9, 3.935728963379753*^9}, 3.935735973592854*^9, 
   3.935739075459318*^9, 3.935750730580076*^9, 3.935751231979793*^9, 
   3.9357516151289167`*^9, 3.936432544733008*^9, 3.947052866391725*^9, 
   3.94705331953234*^9, 3.947053648227462*^9, 3.947053844279417*^9, 
   3.94705437305048*^9, 3.947062752620327*^9},
 CellLabel->
  "(Local) Out[10]=",ExpressionUUID->"2f8e7ef9-d07f-426c-b55f-e31aa7c1bf7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"getting", " ", "expressions", " ", "for", " ", "parameters"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Get", "[", 
    RowBox[{"modLoc", "<>", "\"\<.pars\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"parameters", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "M$ExtParams"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"parameters", "//", "Length"}]}]}]], "Input",
 CellChangeTimes->{{3.935750756150154*^9, 3.935750756266836*^9}, {
  3.947062757492292*^9, 3.947062759421891*^9}},
 CellLabel->
  "(Local) In[14]:=",ExpressionUUID->"df2f9d8f-c63f-4724-81dc-18372eea0a54"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
   "g1x1x1", ",", "g1x1x2", ",", "g1x1x3", ",", "g1x2x1", ",", "g1x2x2", ",", 
    "g1x2x3", ",", "g1x3x1", ",", "g1x3x2", ",", "g1x3x3", ",", "g2x1x1", ",",
     "g2x1x2", ",", "g2x1x3", ",", "g2x2x1", ",", "g2x2x2", ",", "g2x2x3", ",",
     "g2x3x1", ",", "g2x3x2", ",", "g2x3x3", ",", "g3x1x1", ",", "g3x1x2", ",",
     "g3x1x3", ",", "g3x2x1", ",", "g3x2x2", ",", "g3x2x3", ",", "g3x3x1", ",",
     "g3x3x2", ",", "g3x3x3", ",", "lam1x1x1x1", ",", "lam1x1x1x2", ",", 
    "lam1x1x1x3", ",", "lam1x1x2x1", ",", "lam1x1x2x2", ",", "lam1x1x2x3", ",",
     "lam1x1x3x1", ",", "lam1x1x3x2", ",", "lam1x1x3x3", ",", "lam1x2x1x1", ",",
     "lam1x2x1x2", ",", "lam1x2x1x3", ",", "lam1x2x2x1", ",", "lam1x2x2x2", ",",
     "lam1x2x2x3", ",", "lam1x2x3x1", ",", "lam1x2x3x2", ",", "lam1x2x3x3", ",",
     "lam1x3x1x1", ",", "lam1x3x1x2", ",", "lam1x3x1x3", ",", "lam1x3x2x1", ",",
     "lam1x3x2x2", ",", "lam1x3x2x3", ",", "lam1x3x3x1", ",", "lam1x3x3x2", ",",
     "lam1x3x3x3", ",", "lam2x1x1x1", ",", "lam2x1x1x2", ",", "lam2x1x1x3", ",",
     "lam2x1x2x1", ",", "lam2x1x2x2", ",", "lam2x1x2x3", ",", "lam2x1x3x1", ",",
     "lam2x1x3x2", ",", "lam2x1x3x3", ",", "lam2x2x1x1", ",", "lam2x2x1x2", ",",
     "lam2x2x1x3", ",", "lam2x2x2x1", ",", "lam2x2x2x2", ",", "lam2x2x2x3", ",",
     "lam2x2x3x1", ",", "lam2x2x3x2", ",", "lam2x2x3x3", ",", "lam2x3x1x1", ",",
     "lam2x3x1x2", ",", "lam2x3x1x3", ",", "lam2x3x2x1", ",", "lam2x3x2x2", ",",
     "lam2x3x2x3", ",", "lam2x3x3x1", ",", "lam2x3x3x2", ",", "lam2x3x3x3", ",",
     "lam3x1x1x1", ",", "lam3x1x1x2", ",", "lam3x1x1x3", ",", "lam3x1x2x1", ",",
     "lam3x1x2x2", ",", "lam3x1x2x3", ",", "lam3x1x3x1", ",", "lam3x1x3x2", ",",
     "lam3x1x3x3", ",", "lam3x2x1x1", ",", "lam3x2x1x2", ",", "lam3x2x1x3", ",",
     "lam3x2x2x1", ",", "lam3x2x2x2", ",", "lam3x2x2x3", ",", "lam3x2x3x1", ",",
     "lam3x2x3x2", ",", "lam3x2x3x3", ",", "lam3x3x1x1", ",", "lam3x3x1x2", ",",
     "lam3x3x1x3", ",", "lam3x3x2x1", ",", "lam3x3x2x2", ",", "lam3x3x2x3", ",",
     "lam3x3x3x1", ",", "lam3x3x3x2", ",", "lam3x3x3x3", ",", "msq1x1", ",", 
    "msq1x2", ",", "msq1x3", ",", "msq2x1", ",", "msq2x2", ",", "msq2x3", ",",
     "msq3x1", ",", "msq3x2", ",", "msq3x3"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.935750742416089*^9, 3.9357507565803556`*^9}, 
   3.935751233690605*^9, 3.935751615133554*^9, 3.9364325447367573`*^9, 
   3.947052868868495*^9, 3.947053321073925*^9, 3.9470536499499683`*^9, 
   3.947053844282291*^9, 3.9470543730941067`*^9, {3.9470627526408167`*^9, 
   3.9470627598811617`*^9}},
 CellLabel->
  "(Local) Out[15]=",ExpressionUUID->"14f2f7a3-959e-43fe-9bfb-5cd7813c8902"],

Cell[BoxData[
 FormBox["117", TraditionalForm]], "Output",
 CellChangeTimes->{{3.935750742416089*^9, 3.9357507565803556`*^9}, 
   3.935751233690605*^9, 3.935751615133554*^9, 3.9364325447367573`*^9, 
   3.947052868868495*^9, 3.947053321073925*^9, 3.9470536499499683`*^9, 
   3.947053844282291*^9, 3.9470543730941067`*^9, {3.9470627526408167`*^9, 
   3.947062759882039*^9}},
 CellLabel->
  "(Local) Out[16]=",ExpressionUUID->"fe8131c2-d557-4947-8650-b6515095ac6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"indices", " ", "for", " ", "particles"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mapParticleToInteger", ":=", 
     RowBox[{"Thread", "[", 
      RowBox[{"particleTypes", "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "particleTypes", "]"}], "]"}], "-", "1"}], 
        ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "mapParticleToInteger", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"makeMName", "[", "process_", "]"}], ":=", 
    RowBox[{
     RowBox[{"M", "[", 
      RowBox[{
       RowBox[{"process", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"process", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"process", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"process", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "/.", 
     "mapParticleToInteger"}]}]}]}]], "Input",
 CellChangeTimes->{{3.935519108771131*^9, 3.935519116409436*^9}, {
  3.935519159054694*^9, 3.935519166683959*^9}, {3.935750797899083*^9, 
  3.935750804846677*^9}},
 CellLabel->
  "(Local) In[17]:=",ExpressionUUID->"23039e3d-3c71-4845-88f7-37037ba7ce4d"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "(", 
      RowBox[{"1", ",", 
       RowBox[{"{", "1", "}"}]}], ")"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"S", "(", 
      RowBox[{"1", ",", 
       RowBox[{"{", "2", "}"}]}], ")"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"S", "(", 
      RowBox[{"1", ",", 
       RowBox[{"{", "3", "}"}]}], ")"}], "\[Rule]", "2"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9355191187522*^9, 3.935519167011503*^9, 3.935519393176126*^9, 
   3.9355194287264843`*^9, {3.935637215579294*^9, 3.935637244301227*^9}, 
   3.935638798636213*^9, 3.9356455885133677`*^9, 3.9357273919787703`*^9, 
   3.935728967561171*^9, 3.935735973610675*^9, 3.9357390754797983`*^9, 
   3.935750808860111*^9, 3.935751234481867*^9, 3.9357513016668663`*^9, 
   3.935751615143201*^9, 3.9364325447472143`*^9, 3.9470528762582273`*^9, 
   3.947053322659507*^9, 3.947053651250692*^9, 3.947053844293487*^9, 
   3.947054375015851*^9, 3.947062762043442*^9},
 CellLabel->
  "(Local) Out[18]=",ExpressionUUID->"0f5bbc50-6ca7-4568-8176-b0e1bcb3de08"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing matrix elements", "Chapter",
 CellChangeTimes->{{3.929075763355721*^9, 3.929075766225482*^9}, {
  3.93575162099209*^9, 
  3.935751624182454*^9}},ExpressionUUID->"49004534-9081-4e18-af70-\
0f8568b2a3a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dimension", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tops", "=", 
   RowBox[{"CreateTopologies", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "->", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momenta", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Momentum", "[", 
      RowBox[{"p1", ",", "dimension"}], "]"}], ",", 
     RowBox[{"Momentum", "[", 
      RowBox[{"p2", ",", "dimension"}], "]"}], ",", 
     RowBox[{"Momentum", "[", 
      RowBox[{"p3", ",", "dimension"}], "]"}], ",", 
     RowBox[{"Momentum", "[", 
      RowBox[{"p4", ",", "dimension"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indices", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.933906889130355*^9, {3.933911817358987*^9, 3.93391182182825*^9}, {
   3.933913202394904*^9, 3.9339132318972683`*^9}, {3.9343472014290457`*^9, 
   3.934347204249823*^9}, {3.934347277247624*^9, 3.934347305727003*^9}, {
   3.93434773088161*^9, 3.934347739456812*^9}, {3.934348072313307*^9, 
   3.934348083723092*^9}, {3.9343492360717278`*^9, 3.934349240257479*^9}, {
   3.934349355127749*^9, 3.934349355289405*^9}, 3.9343494753243437`*^9, {
   3.934350122837312*^9, 3.934350143607397*^9}, {3.934862455790564*^9, 
   3.93486245771926*^9}, {3.935646873751331*^9, 3.935646898405034*^9}, {
   3.935727436098512*^9, 3.935727459237951*^9}, {3.935750827450709*^9, 
   3.935750842476226*^9}, {3.935751095584155*^9, 3.935751095992384*^9}, 
   3.935751265354184*^9},
 CellLabel->
  "(Local) In[20]:=",ExpressionUUID->"e19637cd-9246-483f-9865-9af615165b4a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "makeAmplitude", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeAmplitude", "[", 
   RowBox[{"process_", ",", 
    RowBox[{"channels_", ":", "All"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "diags", ",", "ampFA", ",", "ampFC", ",", "ampSq", ",", " ", "ampMsq", ",",
       "ampMsqSummed", ",", "masses", ",", "i", ",", "transverse"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"assumes", " ", "2"}], "->", 
      RowBox[{"2", " ", "topology"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"create", " ", "diagrams", " ", "for", " ", "process"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"diags", "=", 
      RowBox[{"InsertFields", "[", 
       RowBox[{
        RowBox[{"tops", "[", 
         RowBox[{"[", "channels", "]"}], "]"}], ",", "process", ",", 
        RowBox[{"InsertionLevel", "\[Rule]", 
         RowBox[{"{", "Particles", "}"}]}], ",", 
        RowBox[{"Model", "->", "modLoc"}], ",", 
        RowBox[{"GenericModel", "->", "modLoc"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "create", " ", "FeynArts", " ", "amplitude", " ", "from", " ", 
       "diagrams"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampFA", "[", "1", "]"}], "=", 
      RowBox[{"CreateFeynAmp", "[", 
       RowBox[{"diags", ",", 
        RowBox[{"PreFactor", "\[Rule]", "1"}], ",", 
        RowBox[{"Truncated", "->", "False"}], ",", 
        RowBox[{"GaugeRules", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"GaugeXi", "[", 
             RowBox[{"S", "[", "_", "]"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{
            RowBox[{"GaugeXi", "[", 
             RowBox[{"V", "[", "_", "]"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{
            RowBox[{"FAGaugeXi", "[", 
             RowBox[{"S", "[", "_", "]"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{
            RowBox[{"FAGaugeXi", "[", 
             RowBox[{"V", "[", "_", "]"}], "]"}], "\[Rule]", "1"}]}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampFA", "[", "2", "]"}], "=", 
      RowBox[{
       RowBox[{"ampFA", "[", "1", "]"}], "/.", 
       RowBox[{
        RowBox[{"PropagatorDenominator", "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"FeynAmpDenominator", "[", 
         RowBox[{"PropagatorDenominator", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"transverse", " ", "momenta"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"transverse", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "4"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"process", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"indices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/.", 
             RowBox[{"List", "->", "Sequence"}]}], "]"}], "]"}], "==", 
          RowBox[{"V", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"transverse", ",", 
           RowBox[{"momenta", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"converting", " ", "to", " ", "FeynCalc", " ", "form"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampFC", "[", "1", "]"}], "=", 
      RowBox[{"FCFAConvert", "[", 
       RowBox[{
        RowBox[{"ampFA", "[", "2", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"IncomingMomenta", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Momentum", "[", 
            RowBox[{"p1", ",", "dimension"}], "]"}], ",", 
           RowBox[{"Momentum", "[", 
            RowBox[{"p2", ",", "dimension"}], "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OutgoingMomenta", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Momentum", "[", 
            RowBox[{"p3", ",", "dimension"}], "]"}], ",", 
           RowBox[{"Momentum", "[", 
            RowBox[{"p4", ",", "dimension"}], "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"LorentzIndexNames", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Rho]", ",", "\[Sigma]"}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ChangeDimension", "\[Rule]", "dimension"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"List", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"SMP", "->", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Contract", "->", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"DropSumOver", "\[Rule]", "False"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"UndoChiralSplittings", "->", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TransversePolarizationVectors", "->", "transverse"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampFC", "[", "2", "]"}], "=", 
      RowBox[{"ampFC", "[", "1", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"/.", 
       RowBox[{
        RowBox[{"PropagatorDenominator", "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"FeynAmpDenominator", "[", 
         RowBox[{"PropagatorDenominator", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}]}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampFC", "[", "3", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ampFC", "[", "2", "]"}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"Conjugate", "[", "PolarizationVector", "]"}], "[", 
          RowBox[{"_", ",", "a_", ",", "b_"}], "]"}], "->", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"PolarizationVector", "[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"PolarizationVector", "[", 
         RowBox[{"_", ",", "a_", ",", "b_"}], "]"}], "->", 
        RowBox[{"PolarizationVector", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampFC", "[", "4", "]"}], "=", 
      RowBox[{
       RowBox[{"ampFC", "[", "3", "]"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"Spinor", "[", "a__", "]"}], 
         RowBox[{"Spinor", "[", "b__", "]"}]}], "->", 
        RowBox[{
         RowBox[{"Spinor", "[", "a", "]"}], ".", 
         RowBox[{"Spinor", "[", "b", "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"ampFC", "[", "4", "]"}], "//", "Contract"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.929075894107052*^9, 3.929076057213236*^9}, {
   3.9290761037433767`*^9, 3.929076166392042*^9}, {3.929092064719689*^9, 
   3.929092093544846*^9}, {3.929092123841778*^9, 3.929092165646528*^9}, {
   3.9290922082292423`*^9, 3.92909225087777*^9}, {3.9290923353190823`*^9, 
   3.929092412608399*^9}, {3.9290924917604847`*^9, 3.929092492385458*^9}, {
   3.929092536115327*^9, 3.9290925608221817`*^9}, {3.929092677450205*^9, 
   3.929092763497978*^9}, {3.929092878724598*^9, 3.929092900788889*^9}, {
   3.929092966958254*^9, 3.929093015909559*^9}, {3.929093105335787*^9, 
   3.929093110372094*^9}, {3.929094887607358*^9, 3.929094891200402*^9}, {
   3.929094933951954*^9, 3.929094938108746*^9}, {3.929163133641143*^9, 
   3.929163152160817*^9}, {3.929163194794945*^9, 3.929163195429078*^9}, {
   3.929163350361196*^9, 3.929163356957172*^9}, {3.929207089205179*^9, 
   3.929207124707587*^9}, {3.92920756189178*^9, 3.929207562137615*^9}, {
   3.929207953021226*^9, 3.929207954224873*^9}, {3.929593994245974*^9, 
   3.929593999837923*^9}, {3.929594287483955*^9, 3.929594295349435*^9}, 
   3.929603534835824*^9, {3.929603570882513*^9, 3.929603575003572*^9}, {
   3.929603722308836*^9, 3.929603724509448*^9}, 3.929604579949868*^9, 
   3.933825157614958*^9, {3.933906901186544*^9, 3.933906907912687*^9}, {
   3.933911698385335*^9, 3.933911722793387*^9}, {3.933911758579893*^9, 
   3.933911793157419*^9}, {3.933913243761017*^9, 3.933913244461969*^9}, {
   3.933913971519474*^9, 3.933913981363091*^9}, {3.934340794293929*^9, 
   3.934340798870564*^9}, {3.934343007587886*^9, 3.93434300799966*^9}, {
   3.934343119738257*^9, 3.934343124875223*^9}, {3.934343169929793*^9, 
   3.934343181521282*^9}, 3.934343220573367*^9, {3.934343283950222*^9, 
   3.9343433167415743`*^9}, {3.934343346932787*^9, 3.93434343306151*^9}, {
   3.934347015073876*^9, 3.9343471102880707`*^9}, {3.934347418288307*^9, 
   3.934347436618711*^9}, {3.9343475953451233`*^9, 3.934347603274523*^9}, {
   3.934348397000737*^9, 3.934348404042808*^9}, {3.934349458757903*^9, 
   3.934349458911173*^9}, 3.935641403517545*^9, 3.935641853911125*^9, {
   3.935646562899584*^9, 3.93564661671967*^9}, {3.935646778734145*^9, 
   3.935646804780753*^9}, {3.93564805226012*^9, 3.935648072231864*^9}, {
   3.93564873787033*^9, 3.935648740503065*^9}, {3.935751037794231*^9, 
   3.935751040221115*^9}, 3.935751104084297*^9, 3.935751242758947*^9, {
   3.935751320403571*^9, 3.935751320515009*^9}, {3.935751741671961*^9, 
   3.935751767719939*^9}, {3.936432574311307*^9, 3.9364326031555967`*^9}, {
   3.936432644664967*^9, 3.936432792627613*^9}, {3.936432843614078*^9, 
   3.936432852164493*^9}, 3.9364330432802687`*^9, {3.936433094776458*^9, 
   3.936433095245923*^9}, {3.936433127646627*^9, 3.93643312809061*^9}, {
   3.936433170447721*^9, 3.9364331804564047`*^9}, {3.9364348677241373`*^9, 
   3.9364348688329287`*^9}, {3.9364349477041683`*^9, 3.936434948355098*^9}},
 CellLabel->
  "(Local) In[24]:=",ExpressionUUID->"8680e620-c5fd-4647-b023-22fc997a15a9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "makeAmplitudeSquared", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeAmplitudeSquared", "[", 
   RowBox[{"process_", ",", 
    RowBox[{"channels_", ":", "All"}], ",", 
    RowBox[{"simplify_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ampM", ",", "ampSq", ",", " ", "ampMsq", ",", "masses", ",", "stu", ",",
       "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"assumes", " ", "2"}], "->", 
      RowBox[{"2", " ", "topology"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"masses", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"TheMass", ",", 
          RowBox[{"process", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{"TheMass", ",", 
          RowBox[{"process", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stu", "=", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{"masses", "^", "2"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampM", "[", "1", "]"}], "=", 
      RowBox[{"makeAmplitude", "[", 
       RowBox[{"process", ",", "channels"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"making", " ", "amplitude", " ", "squared"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampSq", "[", "1", "]"}], "=", 
      RowBox[{
       RowBox[{"ComplexConjugate", "[", 
        RowBox[{"ampM", "[", "1", "]"}], "]"}], 
       RowBox[{"ampM", "[", "1", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampSq", "[", "2", "]"}], "=", 
      RowBox[{"FeynAmpDenominatorExplicit", "[", 
       RowBox[{"ampSq", "[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"FCClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"insert", " ", "Mandelstam", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"SetMandelstam", "[", 
      RowBox[{"s", ",", "t", ",", "u", ",", "p1", ",", "p2", ",", 
       RowBox[{"-", "p3"}], ",", 
       RowBox[{"-", "p4"}], ",", 
       RowBox[{"(", 
        RowBox[{"masses", "/.", 
         RowBox[{"List", "->", "Sequence"}]}], ")"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampSq", "[", "2", "]"}], "=", 
      RowBox[{
       RowBox[{"FermionSpinSum", "[", 
        RowBox[{"ampSq", "[", "2", "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"DiracTrace", "[", "aaa__", "]"}], "->", 
        RowBox[{"DiracTrace", "[", 
         RowBox[{"aaa", ",", 
          RowBox[{"Mandelstam", "->", 
           RowBox[{"{", 
            RowBox[{"s", ",", "t", ",", "u", ",", "stu"}], "}"}]}]}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampSq", "[", "3", "]"}], "=", 
      RowBox[{"DiracSimplify", "[", 
       RowBox[{"ampSq", "[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "4"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"setting", " ", "on"}], "-", 
         RowBox[{"shell", " ", "momenta"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"masses", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{
             RowBox[{"momenta", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"momenta", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ":=", "0"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"summing", " ", "over", " ", "polarizations"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ampSq", "[", 
          RowBox[{"i", "+", "3"}], "]"}], "=", 
         RowBox[{"ampSq", "[", 
          RowBox[{"i", "+", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"process", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"indices", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/.", 
              RowBox[{"List", "->", "Sequence"}]}], "]"}], "]"}], "==", 
           RowBox[{"V", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ampSq", "[", 
            RowBox[{"i", "+", "3"}], "]"}], "=", 
           RowBox[{
            RowBox[{"ampSq", "[", 
             RowBox[{"i", "+", "2"}], "]"}], "//", 
            RowBox[{
             RowBox[{"DoPolarizationSums", "[", 
              RowBox[{"#", ",", 
               RowBox[{"momenta", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], 
             "&"}]}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampMsq", "[", "1", "]"}], "=", 
      RowBox[{"PropagatorDenominatorExplicit", "[", 
       RowBox[{"ampSq", "[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", "simplify", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ampMsq", "[", "2", "]"}], "=", 
      RowBox[{"Expand", "[", 
       RowBox[{"TrickMandelstam", "[", 
        RowBox[{
         RowBox[{"ampSq", "[", "1", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "t", ",", "u", ",", 
           RowBox[{"Plus", "@@", 
            RowBox[{"(", "masses", ")"}]}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FCClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Return", "[", 
      RowBox[{"ampMsq", "[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.929163292792371*^9, 3.929163358613777*^9}, {
   3.929163391434505*^9, 3.929163397696303*^9}, {3.929207568257083*^9, 
   3.929207600997341*^9}, {3.929207646151352*^9, 3.929207646270399*^9}, {
   3.9292079237436*^9, 3.929207937092461*^9}, {3.92920803270984*^9, 
   3.929208032829627*^9}, {3.929417933803673*^9, 3.929417965977117*^9}, {
   3.929418174849358*^9, 3.929418175258651*^9}, {3.929594393852467*^9, 
   3.929594401188664*^9}, {3.929603578465671*^9, 3.929603580647114*^9}, {
   3.929603657355739*^9, 3.9296036680053453`*^9}, {3.9296037535567293`*^9, 
   3.9296037536002007`*^9}, {3.9296038742334538`*^9, 3.929603951549081*^9}, {
   3.929604014027938*^9, 3.929604033682198*^9}, {3.929604259235312*^9, 
   3.929604268592654*^9}, {3.929604405439997*^9, 3.929604446934186*^9}, {
   3.92960453885318*^9, 3.9296045424743*^9}, 3.929604654550357*^9, {
   3.929604732921293*^9, 3.929604749756429*^9}, {3.929704132124748*^9, 
   3.929704143415285*^9}, {3.933827862166714*^9, 3.933827867647903*^9}, 
   3.933911642926285*^9, {3.933911801336119*^9, 3.933911803535879*^9}, {
   3.933911892837012*^9, 3.933911927143033*^9}, {3.933912143369272*^9, 
   3.933912147439457*^9}, {3.933912487506222*^9, 3.933912491510787*^9}, {
   3.933913186637265*^9, 3.933913186673224*^9}, {3.933913252636944*^9, 
   3.933913252861935*^9}, {3.933913858373026*^9, 3.933913860960552*^9}, {
   3.933913907702012*^9, 3.933913923599736*^9}, {3.933914166161413*^9, 
   3.933914183688211*^9}, {3.93391426941628*^9, 3.93391429624463*^9}, {
   3.933914352556963*^9, 3.933914354893138*^9}, {3.933914457098569*^9, 
   3.933914475505293*^9}, 3.933914545173667*^9, {3.934340552204359*^9, 
   3.93434055912149*^9}, {3.93434081963873*^9, 3.9343408354724407`*^9}, {
   3.934347115803708*^9, 3.934347178475627*^9}, {3.934347330064329*^9, 
   3.934347335516551*^9}, {3.934347403077129*^9, 3.93434740475576*^9}, {
   3.934347610410492*^9, 3.9343476193673*^9}, {3.934347701572644*^9, 
   3.934347709534422*^9}, {3.934348465346504*^9, 3.9343484675978527`*^9}, {
   3.934349002057576*^9, 3.934349075476183*^9}, {3.934349147881852*^9, 
   3.934349223993475*^9}, {3.934349273341917*^9, 3.934349320750496*^9}, {
   3.934349374515761*^9, 3.934349456722463*^9}, {3.934350059922199*^9, 
   3.934350105961728*^9}, {3.934350150505369*^9, 3.934350247075732*^9}, {
   3.9343502932126093`*^9, 3.93435041680386*^9}, {3.934350462385359*^9, 
   3.934350495856331*^9}, {3.9348629433086786`*^9, 3.934862965899262*^9}, {
   3.9348630503643427`*^9, 3.934863153510377*^9}, {3.935490579087469*^9, 
   3.935490580471187*^9}, 3.9356418686453876`*^9, 3.935646731438892*^9, {
   3.935646828492881*^9, 3.9356468288691*^9}, {3.93564688891681*^9, 
   3.935646901214143*^9}, 3.935646945411313*^9, {3.935646977848309*^9, 
   3.935646998151428*^9}, {3.935648154671014*^9, 3.935648213424527*^9}, {
   3.935648264366455*^9, 3.935648295152978*^9}, {3.935648327586478*^9, 
   3.935648411282057*^9}, {3.935648477462486*^9, 3.935648502976279*^9}, {
   3.935648537921468*^9, 3.935648553080236*^9}, {3.935648937980735*^9, 
   3.935648997526138*^9}, {3.935727959103112*^9, 3.935727961414198*^9}, {
   3.93572820087499*^9, 3.935728286233938*^9}, {3.935729275219878*^9, 
   3.935729287165559*^9}, {3.935729335230828*^9, 3.935729336698476*^9}, {
   3.9357293927524242`*^9, 3.935729407949136*^9}, {3.935729734679187*^9, 
   3.935729737225625*^9}, {3.935730011206323*^9, 3.935730012366373*^9}, {
   3.9357510201436977`*^9, 3.9357510244542212`*^9}, {3.935751135499444*^9, 
   3.935751171150434*^9}, 3.935751336647619*^9, {3.935751772929392*^9, 
   3.935751775372311*^9}, {3.9364325229589767`*^9, 3.936432534505693*^9}, 
   3.9364330157249517`*^9},
 CellLabel->
  "(Local) In[26]:=",ExpressionUUID->"c63ce969-75cd-4863-abef-d2197a5b96a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "squared", " ", "summed", " ", "matrix", " ", "elements", " ", "with", " ",
     "a", " ", "scalar", " ", "on", " ", "leg", " ", "1"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"results", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"makeMName", "[", "process", "]"}], "->", 
               RowBox[{"makeAmplitudeSquared", "[", 
                RowBox[{"process", ",", "All", ",", "False"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"process", ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"makeProcesses", "[", "#", "]"}], "]"}]}], "}"}]}], 
             "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"_", "->", "0"}]}], "]"}], "&"}], ",", 
         "\[IndentingNewLine]", "particleTypes"}], "]"}], "]"}], "/.", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"TheMass", "[", "#", "]"}], "->", "0"}], "&"}], ",", 
        "particleTypes"}], "]"}]}], "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"msq", "[", "indices__", "]"}], ":>", 
        RowBox[{"msq", "[", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"List", "[", "indices", "]"}], "]"}], "/.", " ", 
          RowBox[{"List", "->", "Sequence"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"g", "[", "indices__", "]"}], ":>", 
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"List", "[", "indices", "]"}], "]"}], "/.", " ", 
          RowBox[{"List", "->", "Sequence"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"lam", "[", "indices__", "]"}], ":>", 
        RowBox[{"lam", "[", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"List", "[", "indices", "]"}], "]"}], "/.", " ", 
          RowBox[{"List", "->", "Sequence"}]}], "]"}]}]}], "}"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.947053357091523*^9, 3.947053417739448*^9}, 
   3.9470535461175957`*^9, {3.9470536704594383`*^9, 3.947053706997571*^9}, {
   3.94705436498687*^9, 3.94705451775159*^9}},
 CellLabel->
  "(Local) In[28]:=",ExpressionUUID->"9a9e25c4-2c77-4400-8749-a512a8efc010"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"results", "=", 
  RowBox[{"results", "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.9470534233301907`*^9, 3.9470534367225018`*^9}, {
   3.9470534779091377`*^9, 3.947053487186517*^9}, 3.9470537202541018`*^9, {
   3.9470627843093767`*^9, 3.947062785033978*^9}},
 CellLabel->
  "(Local) In[29]:=",ExpressionUUID->"aa8597f6-206b-4adb-99ac-10ece79295f0"],

Cell[BoxData[
 FormBox[
  TemplateBox[<|"shortenedBoxes" -> TagBox[
      RowBox[{"{", 
        RowBox[{
          RowBox[{
            RowBox[{"M", "(", 
              RowBox[{"0", ",", "0", ",", "0", ",", "0"}], ")"}], "\[Rule]", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
                RowBox[{
                  RowBox[{"s", " ", "u", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "1"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "2"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "3"}], ")"}], "2"]}], ")"}]}],
                   "+", 
                  RowBox[{"t", " ", "u", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "1"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "2"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "3"}], ")"}], "2"]}], ")"}]}],
                   "+", 
                  RowBox[{"s", " ", "t", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "1"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "2"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "3"}], ")"}], "2"], "+", 
                    RowBox[{"u", " ", 
                    RowBox[{"lam", "(", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], ")"}]}]}], 
                    ")"}]}]}], ")"}], "2"], 
             RowBox[{
               SuperscriptBox["s", "2"], " ", 
               SuperscriptBox["t", "2"], " ", 
               SuperscriptBox["u", "2"]}]]}], ",", 
          RowBox[{
            RowBox[{"M", "(", 
              RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}], "\[Rule]", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
                RowBox[{
                  RowBox[{"s", " ", "u", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "1"}], ")"}], " ", 
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "2", ",", "2"}], ")"}], " ", 
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "3"}], ")"}], " ", 
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "2", ",", "3"}], ")"}]}]}], ")"}]}], 
                  "+", 
                  RowBox[{"t", " ", "u", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "1"}], ")"}], " ", 
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "2", ",", "2"}], ")"}], " ", 
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "3"}], ")"}], " ", 
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "2", ",", "3"}], ")"}]}]}], ")"}]}], 
                  "+", 
                  RowBox[{"s", " ", "t", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "1"}], ")"}], " ", 
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "2", ",", "2"}], ")"}], " ", 
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "1", ",", "3"}], ")"}], " ", 
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "2", ",", "3"}], ")"}]}], "+", 
                    RowBox[{"u", " ", 
                    RowBox[{"lam", "(", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], ")"}]}]}], 
                    ")"}]}]}], ")"}], "2"], 
             RowBox[{
               SuperscriptBox["s", "2"], " ", 
               SuperscriptBox["t", "2"], " ", 
               SuperscriptBox["u", "2"]}]]}], ",", 
          TemplateBox[{"78"}, "OutputSizeLimit`Skeleton"], ",", 
          RowBox[{
            RowBox[{"M", "(", 
              RowBox[{"2", ",", "2", ",", "2", ",", "2"}], ")"}], "\[Rule]", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
                RowBox[{
                  RowBox[{"s", " ", "u", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "3", ",", "3"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"2", ",", "3", ",", "3"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"3", ",", "3", ",", "3"}], ")"}], "2"]}], ")"}]}],
                   "+", 
                  RowBox[{"t", " ", "u", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "3", ",", "3"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"2", ",", "3", ",", "3"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"3", ",", "3", ",", "3"}], ")"}], "2"]}], ")"}]}],
                   "+", 
                  RowBox[{"s", " ", "t", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"1", ",", "3", ",", "3"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"2", ",", "3", ",", "3"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"g", "(", 
                    RowBox[{"3", ",", "3", ",", "3"}], ")"}], "2"], "+", 
                    RowBox[{"u", " ", 
                    RowBox[{"lam", "(", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], ")"}]}]}], 
                    ")"}]}]}], ")"}], "2"], 
             RowBox[{
               SuperscriptBox["s", "2"], " ", 
               SuperscriptBox["t", "2"], " ", 
               SuperscriptBox["u", "2"]}]]}]}], "}"}], Short[#, 8]& ], "line" -> 
    29, "sessionID" -> 32636954193803953716, "byteCount" -> 285064, "size" -> 
    8, "stored" -> False, "expr" -> Missing["NotStored"], "wrap" -> 
    OutputSizeLimit`Defer, "version" -> 1|>,
   "OutputSizeLimitTemplate"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.947053403501211*^9, 3.9470534372599497`*^9}, {
   3.947053480533272*^9, 3.94705349880838*^9}, 3.9470537334152527`*^9, 
   3.947053873388419*^9, 3.947054383521269*^9, 3.94705441598597*^9, 
   3.947054521179565*^9, 3.947062790603635*^9},
 CellLabel->
  "(Local) Out[29]=",ExpressionUUID->"403c3b67-a069-44dd-9f10-2125ce8be65e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting to JSON", "Chapter",
 CellChangeTimes->{{3.9338252493010902`*^9, 3.9338252630058727`*^9}, {
  3.9357517230971746`*^9, 
  3.935751725836915*^9}},ExpressionUUID->"452cb467-c2cb-407d-be2d-\
f1613589c6bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"writing", " ", "as", " ", "JSON"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"makeJsonObject", "[", 
     RowBox[{"fields_", ",", "parameters_", ",", "results_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fieldsJson", ",", "matrixElementsJson", ",", "toString", ",", 
        "getRelevantParameters", ",", "replaceSpecials"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "construct", " ", "an", " ", "object", " ", "which", " ", "can", " ", 
        "then", " ", "be", " ", "exported", " ", "to", " ", "JSON"}], "*)"}], 
      
      RowBox[{
       RowBox[{
        RowBox[{"toString", "[", "arg_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringQ", "[", "arg", "]"}], ",", "arg", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"arg", ",", "InputForm"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"replaceSpecials", "[", "arg_", "]"}], ":=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"arg", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Pi\>\"", "->", "\"\<_pi\>\""}], ",", 
            RowBox[{"\"\<s\>\"", "->", "\"\<_s\>\""}], ",", 
            RowBox[{"\"\<t\>\"", "->", "\"\<_t\>\""}], ",", 
            RowBox[{"\"\<u\>\"", "->", "\"\<_u\>\""}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getRelevantParameters", "[", "arg_", "]"}], ":=", 
        RowBox[{"Select", "[", 
         RowBox[{"parameters", ",", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"arg", ",", "#"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fieldsJson", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<index\>\"", "->", 
             RowBox[{"i", "-", "1"}]}], ",", 
            RowBox[{"\"\<name\>\"", "->", 
             RowBox[{"toString", "[", 
              RowBox[{"fields", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "fields", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"matrixElementsJson", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<externalParticles\>\"", "->", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
              RowBox[{
               RowBox[{"M", "[", "a__", "]"}], "->", 
               RowBox[{"List", "[", "a", "]"}]}]}], ",", 
             RowBox[{"\"\<parameters\>\"", "->", 
              RowBox[{"Map", "[", 
               RowBox[{"toString", ",", 
                RowBox[{"getRelevantParameters", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"\"\<expression\>\"", "->", 
              RowBox[{"replaceSpecials", "[", 
               RowBox[{"toString", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]}], "}"}], 
           "&"}], ",", "results"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<particles\>\"", "->", "fieldsJson"}], ",", 
          RowBox[{"\"\<matrixElements\>\"", "->", "matrixElementsJson"}]}], 
         "}"}], "]"}]}]}], "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"here", " ", "for", " ", "the", " ", "Yukawa", " ", "model"}], ",", 
     RowBox[{
     "where", " ", "the", " ", "matrix", " ", "elements", " ", "are", " ", 
      "stored", " ", "in", " ", "the", " ", "object", " ", "called", " ", 
      "MatrixElements"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toExportAsJSON", "=", 
     RowBox[{"makeJsonObject", "[", 
      RowBox[{"particleNames", ",", "parameters", ",", 
       RowBox[{"results", "//", "SMPToSymbol"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"model", ",", "\"\<.json\>\""}], "]"}]}], "}"}], "]"}], ",",
       "toExportAsJSON"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.93551856771027*^9, 3.935518600269931*^9}, 
   3.935519193679269*^9, {3.935519231779974*^9, 3.935519309251521*^9}, 
   3.935519474917756*^9, {3.935519551363652*^9, 3.935519576988494*^9}, {
   3.935520329044094*^9, 3.935520338217939*^9}, 3.935520417354196*^9, {
   3.935520492459708*^9, 3.935520640942428*^9}, {3.935524439084268*^9, 
   3.935524441306099*^9}, 3.935524559557236*^9, {3.935743573885497*^9, 
   3.9357435755025663`*^9}, {3.935743729401927*^9, 3.935743734912713*^9}, {
   3.935743836587569*^9, 3.9357438366490293`*^9}, {3.935744451429291*^9, 
   3.935744454312519*^9}, {3.9357446685860043`*^9, 3.935744669645329*^9}, {
   3.935744741779169*^9, 3.9357447586691318`*^9}, {3.935744958872927*^9, 
   3.935745025028075*^9}, {3.935745258499324*^9, 3.935745258665791*^9}, 
   3.935751728373632*^9},
 CellLabel->
  "(Local) In[30]:=",ExpressionUUID->"cfafe2d1-2b15-4a67-8477-466a799bc985"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1027},
WindowMargins->{{0, Automatic}, {Automatic, -1093}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
CommonDefaultFormatTypes->{"Output"->TraditionalForm},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"965dcbbb-f472-4bad-b3e2-9315bea466b8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 546, 8, 96, "Title",ExpressionUUID->"64705e10-4319-45ae-8006-0f7fed9a3ce6"],
Cell[CellGroupData[{
Cell[1151, 34, 163, 3, 67, "Chapter",ExpressionUUID->"75bede65-65f5-4df8-8be5-8763376545fa"],
Cell[CellGroupData[{
Cell[1339, 41, 1367, 26, 104, "Input",ExpressionUUID->"5033f070-340c-4a47-af38-98cf26302691"],
Cell[CellGroupData[{
Cell[2731, 71, 6757, 139, 26, "Print",ExpressionUUID->"bc28932f-1056-4c36-9655-c7a4266ed275"],
Cell[9491, 212, 3386, 50, 26, "Print",ExpressionUUID->"3ebf1cd5-729f-482a-b356-a0f634462ed2"],
Cell[12880, 264, 3432, 52, 26, "Print",ExpressionUUID->"9b9ef866-ea74-41af-9cc6-0be83f302c80"]
}, Open  ]],
Cell[16327, 319, 586, 13, 26, "Message",ExpressionUUID->"057ad9bf-cfee-409a-8ba5-d04591f6efcd"],
Cell[CellGroupData[{
Cell[16938, 336, 5038, 99, 26, "Print",ExpressionUUID->"dbc116c5-808b-4525-8cec-9a4d2248e362"],
Cell[21979, 437, 3323, 49, 26, "Print",ExpressionUUID->"d561f5d9-f406-46a3-90de-96aed79a0eb8"],
Cell[25305, 488, 3360, 50, 26, "Print",ExpressionUUID->"b7d17920-1cb4-402d-8306-1a1dbe22b49b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28726, 545, 159, 3, 67, "Chapter",ExpressionUUID->"f5b17365-e344-4951-a8bf-682379c5dff6"],
Cell[28888, 550, 1669, 37, 124, "Input",ExpressionUUID->"f40b35fa-4a17-4c6c-b392-b40cd7767db7"],
Cell[CellGroupData[{
Cell[30582, 591, 2482, 60, 104, "Input",ExpressionUUID->"5ebc72a0-de0d-43df-83e8-50a95768348a"],
Cell[33067, 653, 642, 12, 43, "Output",ExpressionUUID->"2f8e7ef9-d07f-426c-b55f-e31aa7c1bf7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33746, 670, 753, 19, 104, "Input",ExpressionUUID->"df2f9d8f-c63f-4724-81dc-18372eea0a54"],
Cell[34502, 691, 2710, 39, 108, "Output",ExpressionUUID->"14f2f7a3-959e-43fe-9bfb-5cd7813c8902"],
Cell[37215, 732, 462, 8, 43, "Output",ExpressionUUID->"fe8131c2-d557-4947-8650-b6515095ac6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37714, 745, 1390, 38, 104, "Input",ExpressionUUID->"23039e3d-3c71-4845-88f7-37037ba7ce4d"],
Cell[39107, 785, 1128, 27, 43, "Output",ExpressionUUID->"0f5bbc50-6ca7-4568-8176-b0e1bcb3de08"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40284, 818, 218, 4, 67, "Chapter",ExpressionUUID->"49004534-9081-4e18-af70-0f8568b2a3a5"],
Cell[40505, 824, 1906, 45, 104, "Input",ExpressionUUID->"e19637cd-9246-483f-9865-9af615165b4a"],
Cell[42414, 871, 10252, 218, 676, "Input",ExpressionUUID->"8680e620-c5fd-4647-b023-22fc997a15a9"],
Cell[52669, 1091, 9963, 213, 594, "Input",ExpressionUUID->"c63ce969-75cd-4863-abef-d2197a5b96a6"],
Cell[62635, 1306, 2531, 64, 165, "Input",ExpressionUUID->"9a9e25c4-2c77-4400-8749-a512a8efc010"],
Cell[CellGroupData[{
Cell[65191, 1374, 380, 7, 43, "Input",ExpressionUUID->"aa8597f6-206b-4adb-99ac-10ece79295f0"],
Cell[65574, 1383, 8672, 192, 136, "Output",ExpressionUUID->"403c3b67-a069-44dd-9f10-2125ce8be65e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74295, 1581, 217, 4, 67, "Chapter",ExpressionUUID->"452cb467-c2cb-407d-be2d-f1613589c6bd"],
Cell[74515, 1587, 5599, 130, 273, "Input",ExpressionUUID->"cfafe2d1-2b15-4a67-8477-466a799bc985"]
}, Open  ]]
}, Open  ]]
}
]
*)

