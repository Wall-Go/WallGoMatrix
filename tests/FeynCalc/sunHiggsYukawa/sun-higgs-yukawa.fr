(****************************
        general info
****************************)
M$ModelName = "sun-higgs-yukawa";

M$Information = {
Authors -> {"O. Gould"},
Institutions -> {"U. Nottingham"},
Emails -> {"oliver.gould@nottingham.ac.uk"},
Date -> "April 16th, 2025"
};

(****************************
        indices
****************************)
IndexRange[ Index[Fundamental] ] = NoUnfold[ Range[3] ];
IndexRange[ Index[Adjoint] ] = NoUnfold[ Range[8] ];

IndexStyle[ Fundamental, k ];
IndexStyle[ Adjoint, a ];

(****************************
        gauge groups
****************************)
M$GaugeGroups = {
    SU3 == {
        Abelian -> False,
        GaugeBoson -> A,
        StructureConstant -> f,
        Representations -> {{T, Fundamental}},
        SymmetricTensor -> dSUN,
        CouplingConstant -> g
    }
};

(****************************
        fields
****************************)
M$ClassesDescription = {
    (* scalar *)
    S[1] == {
        ClassName -> Phi,
        SelfConjugate -> False,
        Indices -> {Index[Fundamental]},
        Mass -> {mPhi, Internal}
    },
    (* vector *)
    V[1] == {
        ClassName -> A,
        SelfConjugate -> True,
        Indices -> {Index[Adjoint]},
        Mass -> 0
    },
    (* ghost *)
    U[1] == {
        ClassName -> ghostA,
        SelfConjugate -> False,
        Indices -> {Index[Adjoint]},
        Ghost -> A,
        QuantumNumbers -> {GhostNumber -> 1},
        Mass -> 0
    },
    (* charged fermion *)
    F[1] == {
		ClassName -> Psi,
        PropagatorArrow -> True,
		SelfConjugate -> False,
        Indices -> {Index[Fundamental]},
		Mass -> {mPsi, Internal}
    },
    (* neutral fermion *)
    F[2] == {
        ClassName -> Chi,
        Chirality -> Right,
        PropagatorArrow -> True,
        SelfConjugate -> False,
        Indices -> {},
        Mass -> {mPsi, Internal}
    },
    (* left-handed projection *)
    F[3] == {
		ClassName -> PsiL,
        Chirality -> Left,
        PropagatorArrow -> True,
		SelfConjugate -> False,
        Indices -> {Index[Fundamental]},
		Mass -> {mPsi, Internal},
        Definitions -> { PsiL[sp1_,k1_] :> Module[{sp2}, ProjM[sp1,sp2] Psi[sp2,k1]] }
    },
    (* right-handed projection *)
    F[4] == {
        ClassName -> ChiR,
        Chirality -> Right,
        PropagatorArrow -> True,
        SelfConjugate -> False,
        Indices -> {},
        Mass -> {mPsi, Internal},
        Definitions -> { ChiR[sp1_] :> Module[{sp2}, ProjP[sp1,sp2] Chi[sp2]] }
    }
};

(****************************
        gauge parameters
****************************)
(* Landau gauge *)
GaugeXi[ V[_] ] = 1;
GaugeXi[ S[1,___] ] = GaugeXi[S];
GaugeXi[S] = 1;

(****************************
        parameters
****************************)
M$Parameters = {
    (* scalar parameters *)
    \[Lambda] == {
        ParameterType -> External,
        ComplexParameter -> False,
        Value -> \[Lambda],
        Description -> "Quartic coupling"
    },
    mPhi == {
        ParameterType -> External,
        ComplexParameter -> False,
        Value -> mPhi,
        Description -> "Scalar mass"
    },

    (* gauge parameters *)
    g == {
        ParameterType -> External,
        ComplexParameter -> False,
        Value -> g,
        Description -> "Gauge coupling"
    },

    (* fermion parameters *)
	mPsi == {
    	ParameterType -> External,
    	Value -> mPsi,
	    ComplexParameter -> False,
    	Description -> "Charged fermion mass"
	},
    mChi == {
    	ParameterType -> External,
    	Value -> mChi,
	    ComplexParameter -> False,
    	Description -> "Neutral fermion mass"
	},

	(* Yukawa coupling *)
    y == {
        ParameterType -> External,
        ComplexParameter -> False,
        Value -> y,
        Description -> "Yukawa coupling"
    }
};

(****************************
        lagrangian
****************************)
L := Module[
    {
        mu,nu,aa,k1,k2,
        LGauge, LGaugeFixing, LGhost, LHiggs, THiggs, VHiggs, LPsiL, LPsiR, LPsi, LChi, LYukawa
    },

    LGauge := -1/4 FS[A, mu, nu, aa] FS[A, mu, nu, aa];

    LGaugeFixing := -1/2 (del[A[mu, aa], mu]) (del[A[nu, aa], nu]);

    LGhost := del[ghostAbar[aa], mu].DC[ghostA[aa], mu];

    THiggs := DC[Phibar[k1], mu] DC[Phi[k1], mu];
    VHiggs := (
        + m^2 Phibar[k1] Phi[k1]
        + \[Lambda] (Phibar[k1] Phi[k1]) * (Phibar[k2] Phi[k2])
    );
    LHiggs = THiggs - VHiggs;

    (* LPsi = I Psibar.Ga[v].DC[Psi,v] - mPsi Psibar.Psi; *)
    (* LChi = I Chibar.Ga[v].DC[Chi,v] - mChi Chibar.Chi; *)
    (* LPsi := ExpandIndices[I Psibar[sp1, k1] Ga[v,sp1,sp2] DC[Psi[sp2,k1],v]]; *)
    (* LChi := ExpandIndices[I Chibar[sp1] Ga[v,sp1,sp2] DC[Chi[sp2],v]]; *)

    LPsiL := ExpandIndices[I PsiLbar[sp1, k1] Ga[v,sp1,sp2] DC[PsiL[sp2,k1],v]];
    LChiR := ExpandIndices[I ChiRbar[sp1] Ga[v,sp1,sp2] DC[ChiR[sp2],v]];
    (* LYukawa = - y Psibar.Phi.Chi; *)
    (* LYukawa := - y Psibar[s1, k1] Chi[s1] Phi[k1] ; *)
    (* LYukawa := - y Phi[k1] PsiLbar[s1, k1] PsiR[s1]  ; *)
    (* LYukawa := - y Phibar[k1] PsiLbar[s1, k1] ChiR[s1]  ; *)
    LYukawa := - y Phi[k1] PsiLbar[s1, k1] ChiR[s1]  ;

    LGauge + LGaugeFixing + LGhost + LHiggs + LPsiL + LChiR + LYukawa + HC[LYukawa]
];
